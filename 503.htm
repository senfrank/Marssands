<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="503_files/filelist.xml">
<link rel=Edit-Time-Data href="503_files/editdata.mso">
<link rel=OLE-Object-Data href="503_files/oledata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]--><o:SmartTagType
 namespaceuri="urn:schemas-microsoft-com:office:smarttags" name="chmetcnv"/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>shengh</o:Author>
  <o:LastAuthor>shengh</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>6410</o:TotalTime>
  <o:LastPrinted>2007-11-04T16:50:00Z</o:LastPrinted>
  <o:Created>2017-12-18T02:49:00Z</o:Created>
  <o:LastSaved>2017-12-18T02:49:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>5058</o:Words>
  <o:Characters>28831</o:Characters>
  <o:Company>lenovo</o:Company>
  <o:Lines>240</o:Lines>
  <o:Paragraphs>67</o:Paragraphs>
  <o:CharactersWithSpaces>33822</o:CharactersWithSpaces>
  <o:Version>16.00</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:TargetScreenSize>800x600</o:TargetScreenSize>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<link rel=themeData href="503_files/themedata.thmx">
<link rel=colorSchemeMapping href="503_files/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:FormsDesign/>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:PunctuationKerning/>
  <w:DrawingGridVerticalSpacing>7.8 pt</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>EN-US</w:LidThemeOther>
  <w:LidThemeAsian>ZH-CN</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:AdjustLineHeightInTable/>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:UseWord2010TableStyleRules/>
   <w:DontGrowAutofit/>
   <w:DontUseIndentAsNumberingTabStop/>
   <w:FELineBreak11/>
   <w:WW11IndentRules/>
   <w:DontAutofitConstrainedTables/>
   <w:AutofitLikeWW11/>
   <w:HangulWidthLikeWW11/>
   <w:UseNormalStyleForList/>
   <w:DontVertAlignCellWithSp/>
   <w:DontBreakConstrainedForcedTables/>
   <w:DontVertAlignInTxbx/>
   <w:Word11KerningPairs/>
   <w:CachedColBalance/>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="false"
  DefSemiHidden="false" DefQFormat="false" LatentStyleCount="375">
  <w:LsdException Locked="false" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" Priority="99" SemiHidden="true"
   Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="99" SemiHidden="true" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" QFormat="true"
   Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" QFormat="true"
   Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" QFormat="true"
   Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" QFormat="true"
   Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" QFormat="true"
   Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" QFormat="true"
   Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" SemiHidden="true"
   UnhideWhenUsed="true" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="TOC Heading"/>
  <w:LsdException Locked="false" Priority="41" Name="Plain Table 1"/>
  <w:LsdException Locked="false" Priority="42" Name="Plain Table 2"/>
  <w:LsdException Locked="false" Priority="43" Name="Plain Table 3"/>
  <w:LsdException Locked="false" Priority="44" Name="Plain Table 4"/>
  <w:LsdException Locked="false" Priority="45" Name="Plain Table 5"/>
  <w:LsdException Locked="false" Priority="40" Name="Grid Table Light"/>
  <w:LsdException Locked="false" Priority="46" Name="Grid Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="Grid Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="Grid Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="46" Name="List Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="List Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="List Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="99" SemiHidden="true"
   UnhideWhenUsed="true" Name="Mention"/>
  <w:LsdException Locked="false" Priority="99" SemiHidden="true"
   UnhideWhenUsed="true" Name="Smart Hyperlink"/>
  <w:LsdException Locked="false" Priority="99" SemiHidden="true"
   UnhideWhenUsed="true" Name="Hashtag"/>
  <w:LsdException Locked="false" Priority="99" SemiHidden="true"
   UnhideWhenUsed="true" Name="Unresolved Mention"/>
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
@font-face
	{font-family:黑体;
	panose-1:2 1 6 9 6 1 1 1 1 1;
	mso-font-alt:SimHei;
	mso-font-charset:134;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-2147482945 953122042 22 0 262145 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-536870145 1107305727 0 0 415 0;}
@font-face
	{font-family:"Lucida Sans";
	panose-1:2 11 6 2 3 5 4 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:2695 0 0 0 191 0;}
@font-face
	{font-family:"\@黑体";
	panose-1:2 1 6 9 6 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-2147482945 953122042 22 0 262145 0;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
h1
	{mso-style-name:"Heading 1\,heading 1";
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:"Normal Indent";
	margin-top:17.0pt;
	margin-right:0cm;
	margin-bottom:16.5pt;
	margin-left:21.25pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-21.25pt;
	mso-line-height-alt:12.0pt;
	mso-pagination:lines-together;
	page-break-after:avoid;
	mso-outline-level:1;
	mso-list:l24 level1 lfo1;
	layout-grid-mode:char;
	mso-layout-grid-align:none;
	font-size:18.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:黑体;
	mso-font-kerning:0pt;
	layout-grid-mode:line;
	font-weight:bold;}
h2
	{mso-style-name:"Heading 2\,heading 2";
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:"Normal Indent";
	margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:49.6pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-49.6pt;
	mso-line-height-alt:12.0pt;
	mso-pagination:lines-together;
	page-break-after:avoid;
	mso-outline-level:2;
	mso-list:l24 level2 lfo1;
	layout-grid-mode:char;
	mso-layout-grid-align:none;
	font-size:14.0pt;
	font-family:"Arial",sans-serif;
	mso-fareast-font-family:黑体;
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:1.0pt;
	font-weight:bold;}
h3
	{mso-style-name:"Heading 3\,heading 3";
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:"Normal Indent";
	margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:70.9pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-70.9pt;
	line-height:12.0pt;
	mso-pagination:lines-together;
	page-break-after:avoid;
	mso-outline-level:3;
	mso-list:l24 level3 lfo1;
	layout-grid-mode:char;
	mso-layout-grid-align:none;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;
	layout-grid-mode:line;
	font-weight:bold;}
h4
	{mso-style-name:"Heading 4\,heading 4";
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:"Normal Indent";
	margin-top:14.0pt;
	margin-right:0cm;
	margin-bottom:14.5pt;
	margin-left:99.2pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-79.35pt;
	line-height:12.0pt;
	mso-pagination:lines-together;
	page-break-after:avoid;
	mso-outline-level:4;
	mso-list:l24 level4 lfo1;
	layout-grid-mode:char;
	font-size:12.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:宋体;
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:1.0pt;
	font-weight:normal;}
p.MsoNormalIndent, li.MsoNormalIndent, div.MsoNormalIndent
	{mso-style-unhide:no;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:21.0pt;
	mso-char-indent-count:2.0;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-unhide:no;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:none;
	tab-stops:center 207.65pt right 415.3pt;
	layout-grid-mode:char;
	border:none;
	mso-border-bottom-alt:solid windowtext .75pt;
	padding:0cm;
	mso-padding-alt:0cm 0cm 1.0pt 0cm;
	font-size:9.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-unhide:no;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:none;
	tab-stops:center 207.65pt right 415.3pt;
	layout-grid-mode:char;
	font-size:9.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
a:link, span.MsoHyperlink
	{mso-style-unhide:no;
	mso-style-parent:"";
	color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-unhide:no;
	color:#954F72;
	mso-themecolor:followedhyperlink;
	text-decoration:underline;
	text-underline:single;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{mso-style-noshow:yes;
	mso-style-unhide:no;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	background:navy;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
p
	{mso-style-unhide:no;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
tt
	{mso-style-unhide:no;
	mso-style-parent:"";
	mso-ansi-font-size:12.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:宋体;
	mso-ascii-font-family:宋体;
	mso-fareast-font-family:宋体;
	mso-hansi-font-family:宋体;
	mso-bidi-font-family:宋体;}
p.Default, li.Default, div.Default
	{mso-style-name:Default;
	mso-style-unhide:no;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:none;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:12.0pt;
	font-family:"Arial",sans-serif;
	mso-fareast-font-family:宋体;
	color:black;}
p.doclist, li.doclist, div.doclist
	{mso-style-name:doclist;
	mso-style-unhide:no;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
p.a, li.a, div.a
	{mso-style-name:a;
	mso-style-unhide:no;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	mso-fareast-font-family:宋体;}
 /* Page Definitions */
 @page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;
	mso-footnote-separator:url("503_files/header.htm") fs;
	mso-footnote-continuation-separator:url("503_files/header.htm") fcs;
	mso-endnote-separator:url("503_files/header.htm") es;
	mso-endnote-continuation-separator:url("503_files/header.htm") ecs;}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-header:url("503_files/header.htm") h1;
	mso-paper-source:0;
	layout-grid:15.6pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 @list l0
	{mso-list-id:13967953;
	mso-list-type:hybrid;
	mso-list-template-ids:1839897552 67698703 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l0:level1
	{mso-level-tab-stop:42.0pt;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l0:level2
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l0:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:63.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l0:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:84.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l0:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l0:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l0:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:147.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l0:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l0:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l1
	{mso-list-id:119306726;
	mso-list-type:hybrid;
	mso-list-template-ids:-1789096696 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l1:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l1:level2
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%2\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:63.0pt;
	text-indent:-21.0pt;}
@list l1:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l1:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l1:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l1:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l1:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l1:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l1:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l2
	{mso-list-id:163058229;
	mso-list-template-ids:968021466;}
@list l2:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l2:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:60.0pt;
	text-indent:-18.0pt;}
@list l2:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l2:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l2:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l2:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l2:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l2:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l2:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l3
	{mso-list-id:224531537;
	mso-list-type:hybrid;
	mso-list-template-ids:1346143560 67698703 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l3:level1
	{mso-level-tab-stop:39.0pt;
	mso-level-number-position:left;
	margin-left:39.0pt;
	text-indent:-21.0pt;}
@list l3:level2
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:60.0pt;
	mso-level-number-position:left;
	margin-left:60.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l3:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:81.0pt;
	mso-level-number-position:left;
	margin-left:81.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l3:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:102.0pt;
	mso-level-number-position:left;
	margin-left:102.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l3:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:123.0pt;
	mso-level-number-position:left;
	margin-left:123.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l3:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:144.0pt;
	mso-level-number-position:left;
	margin-left:144.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l3:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:165.0pt;
	mso-level-number-position:left;
	margin-left:165.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l3:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:186.0pt;
	mso-level-number-position:left;
	margin-left:186.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l3:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:207.0pt;
	mso-level-number-position:left;
	margin-left:207.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l4
	{mso-list-id:231277446;
	mso-list-type:hybrid;
	mso-list-template-ids:-1038327370 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l4:level1
	{mso-level-tab-stop:42.0pt;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l4:level2
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%2\)";
	mso-level-tab-stop:63.0pt;
	mso-level-number-position:left;
	margin-left:63.0pt;
	text-indent:-21.0pt;}
@list l4:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:84.0pt;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l4:level4
	{mso-level-tab-stop:105.0pt;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l4:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:126.0pt;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l4:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:147.0pt;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l4:level7
	{mso-level-tab-stop:168.0pt;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l4:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:189.0pt;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l4:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:210.0pt;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l5
	{mso-list-id:397828394;
	mso-list-type:hybrid;
	mso-list-template-ids:-1082355542 67698703 1243618946 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l5:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l5:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:60.0pt;
	text-indent:-18.0pt;}
@list l5:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l5:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l5:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l5:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l5:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l5:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l5:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l6
	{mso-list-id:621113527;
	mso-list-type:hybrid;
	mso-list-template-ids:218166550 1556222164 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l6:level1
	{mso-level-text:%1、;
	mso-level-tab-stop:39.0pt;
	mso-level-number-position:left;
	margin-left:39.0pt;
	text-indent:-18.0pt;}
@list l6:level2
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%2\)";
	mso-level-tab-stop:63.0pt;
	mso-level-number-position:left;
	margin-left:63.0pt;
	text-indent:-21.0pt;}
@list l6:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:84.0pt;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l6:level4
	{mso-level-tab-stop:105.0pt;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l6:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:126.0pt;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l6:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:147.0pt;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l6:level7
	{mso-level-tab-stop:168.0pt;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l6:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:189.0pt;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l6:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:210.0pt;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l7
	{mso-list-id:636617051;
	mso-list-template-ids:968021466;}
@list l7:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l7:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:60.0pt;
	text-indent:-18.0pt;}
@list l7:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l7:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l7:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l7:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l7:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l7:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l7:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l8
	{mso-list-id:689378425;
	mso-list-type:hybrid;
	mso-list-template-ids:-1807306708 67698703 -1396572018 684882224 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l8:level1
	{mso-level-tab-stop:42.0pt;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l8:level2
	{mso-level-text:%2、;
	mso-level-tab-stop:80.25pt;
	mso-level-number-position:left;
	margin-left:80.25pt;
	text-indent:-38.25pt;}
@list l8:level3
	{mso-level-text:%3．;
	mso-level-tab-stop:99.75pt;
	mso-level-number-position:left;
	margin-left:99.75pt;
	text-indent:-36.75pt;}
@list l8:level4
	{mso-level-tab-stop:105.0pt;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l8:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:126.0pt;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l8:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:147.0pt;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l8:level7
	{mso-level-tab-stop:168.0pt;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l8:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:189.0pt;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l8:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:210.0pt;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l9
	{mso-list-id:756483115;
	mso-list-type:hybrid;
	mso-list-template-ids:663666020 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l9:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:42.0pt;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l9:level2
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:63.0pt;
	mso-level-number-position:left;
	margin-left:63.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l9:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:84.0pt;
	mso-level-number-position:left;
	margin-left:84.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l9:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:105.0pt;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l9:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:126.0pt;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l9:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:147.0pt;
	mso-level-number-position:left;
	margin-left:147.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l9:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:168.0pt;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l9:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:189.0pt;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l9:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:210.0pt;
	mso-level-number-position:left;
	margin-left:210.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l10
	{mso-list-id:909728927;
	mso-list-template-ids:968021466;}
@list l10:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l10:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:60.0pt;
	text-indent:-18.0pt;}
@list l10:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l10:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l10:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l10:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l10:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l10:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l10:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l11
	{mso-list-id:943422574;
	mso-list-type:hybrid;
	mso-list-template-ids:-1312380224 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l11:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:42.0pt;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l11:level2
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:63.0pt;
	mso-level-number-position:left;
	margin-left:63.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l11:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:84.0pt;
	mso-level-number-position:left;
	margin-left:84.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l11:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:105.0pt;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l11:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:126.0pt;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l11:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:147.0pt;
	mso-level-number-position:left;
	margin-left:147.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l11:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:168.0pt;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l11:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:189.0pt;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l11:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:210.0pt;
	mso-level-number-position:left;
	margin-left:210.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l12
	{mso-list-id:1249803276;
	mso-list-type:hybrid;
	mso-list-template-ids:1409824916 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l12:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:42.0pt;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l12:level2
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:63.0pt;
	mso-level-number-position:left;
	margin-left:63.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l12:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:84.0pt;
	mso-level-number-position:left;
	margin-left:84.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l12:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:105.0pt;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l12:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:126.0pt;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l12:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:147.0pt;
	mso-level-number-position:left;
	margin-left:147.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l12:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:168.0pt;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l12:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:189.0pt;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l12:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:210.0pt;
	mso-level-number-position:left;
	margin-left:210.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l13
	{mso-list-id:1346205459;
	mso-list-template-ids:968021466;}
@list l13:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l13:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:60.0pt;
	text-indent:-18.0pt;}
@list l13:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l13:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l13:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l13:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l13:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l13:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l13:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l14
	{mso-list-id:1372346220;
	mso-list-type:hybrid;
	mso-list-template-ids:228359044 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l14:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l14:level2
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%2\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:63.0pt;
	text-indent:-21.0pt;}
@list l14:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l14:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l14:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l14:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l14:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l14:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l14:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l15
	{mso-list-id:1374428037;
	mso-list-type:hybrid;
	mso-list-template-ids:-187901756 67698699 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l15:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0D8;
	mso-level-tab-stop:42.0pt;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l15:level2
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%2\)";
	mso-level-tab-stop:63.0pt;
	mso-level-number-position:left;
	margin-left:63.0pt;
	text-indent:-21.0pt;}
@list l15:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:84.0pt;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l15:level4
	{mso-level-tab-stop:105.0pt;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l15:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:126.0pt;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l15:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:147.0pt;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l15:level7
	{mso-level-tab-stop:168.0pt;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l15:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:189.0pt;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l15:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:210.0pt;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l16
	{mso-list-id:1429737636;
	mso-list-type:hybrid;
	mso-list-template-ids:714005138 67698691 67698703 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l16:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:42.0pt;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l16:level2
	{mso-level-tab-stop:63.0pt;
	mso-level-number-position:left;
	margin-left:63.0pt;
	text-indent:-21.0pt;}
@list l16:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:84.0pt;
	mso-level-number-position:left;
	margin-left:84.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l16:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:105.0pt;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l16:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:126.0pt;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l16:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:147.0pt;
	mso-level-number-position:left;
	margin-left:147.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l16:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:168.0pt;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l16:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:189.0pt;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l16:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:210.0pt;
	mso-level-number-position:left;
	margin-left:210.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l17
	{mso-list-id:1463499639;
	mso-list-template-ids:968021466;}
@list l17:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l17:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:60.0pt;
	text-indent:-18.0pt;}
@list l17:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l17:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l17:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l17:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l17:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l17:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l17:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l18
	{mso-list-id:1509520518;
	mso-list-template-ids:968021466;}
@list l18:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l18:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:60.0pt;
	text-indent:-18.0pt;}
@list l18:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l18:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l18:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l18:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l18:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l18:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l18:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l19
	{mso-list-id:1510952050;
	mso-list-type:hybrid;
	mso-list-template-ids:-414397396 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l19:level1
	{mso-level-tab-stop:42.0pt;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l19:level2
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%2\)";
	mso-level-tab-stop:63.0pt;
	mso-level-number-position:left;
	margin-left:63.0pt;
	text-indent:-21.0pt;}
@list l19:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:84.0pt;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l19:level4
	{mso-level-tab-stop:105.0pt;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l19:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:126.0pt;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l19:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:147.0pt;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l19:level7
	{mso-level-tab-stop:168.0pt;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l19:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:189.0pt;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l19:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:210.0pt;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l20
	{mso-list-id:1538424607;
	mso-list-type:hybrid;
	mso-list-template-ids:890162732 67698689 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l20:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:42.0pt;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l20:level2
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%2\)";
	mso-level-tab-stop:63.0pt;
	mso-level-number-position:left;
	margin-left:63.0pt;
	text-indent:-21.0pt;}
@list l20:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:84.0pt;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l20:level4
	{mso-level-tab-stop:105.0pt;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l20:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:126.0pt;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l20:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:147.0pt;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l20:level7
	{mso-level-tab-stop:168.0pt;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l20:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:189.0pt;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l20:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:210.0pt;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l21
	{mso-list-id:1658341201;
	mso-list-type:hybrid;
	mso-list-template-ids:1985895324 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l21:level1
	{mso-level-tab-stop:42.0pt;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l21:level2
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%2\)";
	mso-level-tab-stop:63.0pt;
	mso-level-number-position:left;
	margin-left:63.0pt;
	text-indent:-21.0pt;}
@list l21:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:84.0pt;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l21:level4
	{mso-level-tab-stop:105.0pt;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l21:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:126.0pt;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l21:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:147.0pt;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l21:level7
	{mso-level-tab-stop:168.0pt;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l21:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:189.0pt;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l21:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:210.0pt;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l22
	{mso-list-id:1738552221;
	mso-list-template-ids:-1082355542;}
@list l22:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l22:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:60.0pt;
	text-indent:-18.0pt;}
@list l22:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l22:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l22:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l22:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l22:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l22:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l22:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l23
	{mso-list-id:1800998358;
	mso-list-type:hybrid;
	mso-list-template-ids:39498150 67698703 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l23:level1
	{mso-level-tab-stop:42.0pt;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l23:level2
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:63.0pt;
	mso-level-number-position:left;
	margin-left:63.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l23:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:84.0pt;
	mso-level-number-position:left;
	margin-left:84.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l23:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:105.0pt;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l23:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:126.0pt;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l23:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:147.0pt;
	mso-level-number-position:left;
	margin-left:147.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l23:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:168.0pt;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l23:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:189.0pt;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l23:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:210.0pt;
	mso-level-number-position:left;
	margin-left:210.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l24
	{mso-list-id:1803646617;
	mso-list-template-ids:87981124;}
@list l24:level1
	{mso-level-style-link:"Heading 1";
	mso-level-suffix:space;
	mso-level-text:%1;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:21.25pt;
	text-indent:-21.25pt;}
@list l24:level2
	{mso-level-style-link:"Heading 2";
	mso-level-suffix:space;
	mso-level-text:"%1\.%2";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:49.6pt;
	text-indent:-49.6pt;}
@list l24:level3
	{mso-level-style-link:"Heading 3";
	mso-level-suffix:space;
	mso-level-text:"%1\.%2\.%3";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:70.9pt;
	text-indent:-70.9pt;}
@list l24:level4
	{mso-level-style-link:"Heading 4";
	mso-level-suffix:space;
	mso-level-text:"%1\.%2\.%3\.%4";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:99.2pt;
	text-indent:-79.35pt;}
@list l24:level5
	{mso-level-text:"%1\.%2\.%3\.%4\.%5";
	mso-level-tab-stop:139.05pt;
	mso-level-number-position:left;
	margin-left:127.55pt;
	text-indent:-42.5pt;}
@list l24:level6
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6";
	mso-level-tab-stop:163.0pt;
	mso-level-number-position:left;
	margin-left:163.0pt;
	text-indent:-2.0cm;}
@list l24:level7
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7";
	mso-level-tab-stop:199.55pt;
	mso-level-number-position:left;
	margin-left:191.35pt;
	text-indent:-63.8pt;}
@list l24:level8
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8";
	mso-level-tab-stop:238.8pt;
	mso-level-number-position:left;
	margin-left:219.7pt;
	text-indent:-70.9pt;}
@list l24:level9
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8\.%9";
	mso-level-tab-stop:255.1pt;
	mso-level-number-position:left;
	margin-left:255.1pt;
	text-indent:-85.0pt;}
@list l25
	{mso-list-id:1814909575;
	mso-list-type:hybrid;
	mso-list-template-ids:-1735362726 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l25:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:42.0pt;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l25:level2
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:63.0pt;
	mso-level-number-position:left;
	margin-left:63.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l25:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:84.0pt;
	mso-level-number-position:left;
	margin-left:84.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l25:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:105.0pt;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l25:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:126.0pt;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l25:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:147.0pt;
	mso-level-number-position:left;
	margin-left:147.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l25:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:168.0pt;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l25:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:189.0pt;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l25:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:210.0pt;
	mso-level-number-position:left;
	margin-left:210.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l26
	{mso-list-id:1816138944;
	mso-list-template-ids:968021466;}
@list l26:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l26:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:60.0pt;
	text-indent:-18.0pt;}
@list l26:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l26:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l26:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l26:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l26:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l26:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l26:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l27
	{mso-list-id:1818910383;
	mso-list-template-ids:968021466;}
@list l27:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l27:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:60.0pt;
	text-indent:-18.0pt;}
@list l27:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l27:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l27:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l27:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l27:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l27:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l27:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l28
	{mso-list-id:1865052994;
	mso-list-type:hybrid;
	mso-list-template-ids:-56848054 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l28:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:42.0pt;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l28:level2
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:63.0pt;
	mso-level-number-position:left;
	margin-left:63.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l28:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:84.0pt;
	mso-level-number-position:left;
	margin-left:84.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l28:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:105.0pt;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l28:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:126.0pt;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l28:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:147.0pt;
	mso-level-number-position:left;
	margin-left:147.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l28:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:168.0pt;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l28:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:189.0pt;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l28:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:210.0pt;
	mso-level-number-position:left;
	margin-left:210.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l29
	{mso-list-id:1889340458;
	mso-list-template-ids:968021466;}
@list l29:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l29:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:60.0pt;
	text-indent:-18.0pt;}
@list l29:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l29:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l29:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l29:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l29:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l29:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l29:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l30
	{mso-list-id:2013753987;
	mso-list-type:hybrid;
	mso-list-template-ids:-1014055804 67698705 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l30:level1
	{mso-level-text:"%1\)";
	mso-level-tab-stop:39.0pt;
	mso-level-number-position:left;
	margin-left:39.0pt;
	text-indent:-21.0pt;}
@list l30:level2
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:60.0pt;
	mso-level-number-position:left;
	margin-left:60.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l30:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:81.0pt;
	mso-level-number-position:left;
	margin-left:81.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l30:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:102.0pt;
	mso-level-number-position:left;
	margin-left:102.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l30:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:123.0pt;
	mso-level-number-position:left;
	margin-left:123.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l30:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:144.0pt;
	mso-level-number-position:left;
	margin-left:144.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l30:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:165.0pt;
	mso-level-number-position:left;
	margin-left:165.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l30:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:186.0pt;
	mso-level-number-position:left;
	margin-left:186.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l30:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:207.0pt;
	mso-level-number-position:left;
	margin-left:207.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l31
	{mso-list-id:2057775997;
	mso-list-template-ids:968021466;}
@list l31:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:42.0pt;
	text-indent:-21.0pt;}
@list l31:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:60.0pt;
	text-indent:-18.0pt;}
@list l31:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:84.0pt;
	text-indent:-21.0pt;}
@list l31:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:105.0pt;
	text-indent:-21.0pt;}
@list l31:level5
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%5\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:126.0pt;
	text-indent:-21.0pt;}
@list l31:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:147.0pt;
	text-indent:-21.0pt;}
@list l31:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:168.0pt;
	text-indent:-21.0pt;}
@list l31:level8
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%8\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:189.0pt;
	text-indent:-21.0pt;}
@list l31:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:210.0pt;
	text-indent:-21.0pt;}
@list l32
	{mso-list-id:2118520898;
	mso-list-type:hybrid;
	mso-list-template-ids:-420309224 67698701 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l32:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B2;
	mso-level-tab-stop:39.0pt;
	mso-level-number-position:left;
	margin-left:39.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l32:level2
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:60.0pt;
	mso-level-number-position:left;
	margin-left:60.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l32:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:81.0pt;
	mso-level-number-position:left;
	margin-left:81.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l32:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:102.0pt;
	mso-level-number-position:left;
	margin-left:102.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l32:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:123.0pt;
	mso-level-number-position:left;
	margin-left:123.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l32:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:144.0pt;
	mso-level-number-position:left;
	margin-left:144.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l32:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:165.0pt;
	mso-level-number-position:left;
	margin-left:165.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l32:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F06E;
	mso-level-tab-stop:186.0pt;
	mso-level-number-position:left;
	margin-left:186.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
@list l32:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F075;
	mso-level-tab-stop:207.0pt;
	mso-level-number-position:left;
	margin-left:207.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-unhide:no;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
table.MsoTableGrid
	{mso-style-name:"Table Grid";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-unhide:no;
	border:solid windowtext 1.0pt;
	mso-border-alt:solid windowtext .5pt;
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-border-insideh:.5pt solid windowtext;
	mso-border-insidev:.5pt solid windowtext;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1026"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US link=blue vlink="#954F72" style='tab-interval:21.0pt;
text-justify-trim:punctuation'>

<div class=WordSection1 style='layout-grid:15.6pt'>

<h1 style='mso-list:l24 level1 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>1
</span></span><![endif]>kernel_thread<span lang=ZH-CN style='font-family:黑体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的实现</span></h1>
<p style='mso-list:l24 level1 lfo1'><span style="mso-list:l7 level1 lfo1">frank_seng(frank_seng@163.com)</span></p>
<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>我们首先来看看内核编译后的汇编代码，使用</span>objdump
–D /linuxkernel/vmlinux &gt; kernel<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>来生成内核的汇编代码，我们来看看其中相关的两处</span>C<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>代码及其汇编代码：</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:322.5pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#E6E6E6;padding:0cm 5.4pt 0cm 5.4pt;
  height:322.5pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>......<span style='mso-tab-count:1'>&nbsp; </span><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>int</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>kernel</span><span style='font-size:9.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>thread</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>(</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>int</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> (*</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>fn</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>)(</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>void</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> *), </span><span style='font-size:9.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>void</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> * </span><span
  style='font-size:9.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>arg</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>, </span><span style='font-size:9.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>unsigned</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>long</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> </span><span
  style='font-size:9.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>flags</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>{<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>long</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>retval</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>, </span><span style='font-size:9.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>d0</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:black;mso-font-kerning:0pt'>__</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>asm</span><span style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>__</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>__</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>volatile</span><span style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>__</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>(<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#000077;mso-font-kerning:
  0pt'>&quot;movl %%esp,%%esi\n\t&quot;</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#000077;mso-font-kerning:
  0pt'>&quot;int $0x80\n\t&quot;</span><span style='font-size:9.0pt;font-family:
  "Courier New";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
  2'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='font-size:9.0pt;
  font-family:"Courier New";color:#009900;mso-font-kerning:0pt'>/* Linux/i386
  system call */</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#000077;mso-font-kerning:
  0pt'>&quot;cmpl %%esp,%%esi\n\t&quot;</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'> </span></span><span style='font-size:9.0pt;
  font-family:"Courier New";color:#009900;mso-font-kerning:0pt'>/* child or
  parent? */</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#000077;mso-font-kerning:
  0pt'>&quot;je <st1:chmetcnv TCSC="0" NumberType="1" Negative="False"
  HasSpace="False" SourceValue="1" UnitName="F" w:st="on">1f</st1:chmetcnv>\n\t&quot;</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>/* parent - jump */</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>/* Load the argument into eax, and push it.<span
  style='mso-spacerun:yes'>&nbsp; </span>That way, it does<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:#009900;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='mso-spacerun:yes'>&nbsp;</span>* not matter whether the called
  function is compiled with<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:#009900;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='mso-spacerun:yes'>&nbsp;</span>* -mregparm or not.<span
  style='mso-spacerun:yes'>&nbsp; </span>*/</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#000077;mso-font-kerning:
  0pt'>&quot;movl %4,%%eax\n\t&quot;</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#000077;mso-font-kerning:
  0pt'>&quot;pushl %%eax\n\t&quot;</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#000077;mso-font-kerning:
  0pt'>&quot;call *%5\n\t&quot;</span><span style='font-size:9.0pt;font-family:
  "Courier New";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
  2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='font-size:9.0pt;
  font-family:"Courier New";color:#009900;mso-font-kerning:0pt'>/* call fn */</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#000077;mso-font-kerning:
  0pt'>&quot;movl %3,%0\n\t&quot;</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>/* exit */</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#000077;mso-font-kerning:
  0pt'>&quot;int $0x80\n&quot;</span><span style='font-size:9.0pt;font-family:
  "Courier New";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#000077;mso-font-kerning:
  0pt'>&quot;1:\t&quot;</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>:</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#000077;mso-font-kerning:
  0pt'>&quot;=&amp;a&quot;</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>retval</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>), </span><span style='font-size:9.0pt;font-family:"Courier New";
  color:#000077;mso-font-kerning:0pt'>&quot;=&amp;S&quot;</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>d0</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>:</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#000077;mso-font-kerning:
  0pt'>&quot;0&quot;</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (</span><span style='font-size:9.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>__</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>NR</span><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>clone), </span><span style='font-size:9.0pt;font-family:"Courier New";
  color:#000077;mso-font-kerning:0pt'>&quot;i&quot;</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (</span><span style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>__</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>NR</span><span style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>exit),<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='mso-spacerun:yes'>&nbsp;</span></span><span style='font-size:9.0pt;
  font-family:"Courier New";color:#000077;mso-font-kerning:0pt'>&quot;r&quot;</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>arg</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>), </span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#000077;mso-font-kerning:
  0pt'>&quot;r&quot;</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>fn</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>),<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='mso-spacerun:yes'>&nbsp;</span></span><span style='font-size:9.0pt;
  font-family:"Courier New";color:#000077;mso-font-kerning:0pt'>&quot;b&quot;</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>flags</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> | CLONE</span><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>VM)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>: </span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#000077;mso-font-kerning:
  0pt'>&quot;memory&quot;</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>return</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>retval</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>}<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>asmlinkage </span><span
  style='font-size:9.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>void</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>__</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>init </span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>start</span><span style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>kernel</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>(</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>void</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>{<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>......<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>smp</span><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>init();<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>kernel</span><span style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>thread</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>(</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>init</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>, </span><span style='font-size:9.0pt;font-family:"Courier New";
  color:#A000A0;mso-font-kerning:0pt'>NULL</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>, CLONE</span><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>FS | CLONE</span><span style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>FILES | CLONE</span><span style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>SIGNAL);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>......<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>}</span><span
  style='font-size:9.0pt;font-family:"Courier New"'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent style='mso-char-indent-count:0'><span
style='mso-bidi-font-size:10.5pt;font-family:"Courier New";color:black;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:15.1pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#E6E6E6;padding:0cm 5.4pt 0cm 5.4pt;
  height:15.1pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>......<span style='mso-tab-count:1'>&nbsp; </span><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:red'>c0107520 &lt;kernel</span><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:red'>_</span><span style='font-size:9.0pt;font-family:
  "Courier New";color:red'>thread&gt;:<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c0107520:<span style='mso-tab-count:1'>&nbsp;&nbsp; </span>56<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
  style='mso-tab-count:1'>&nbsp; </span>push<span
  style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span style='mso-tab-count:1'> </span>%esi<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c0107521:<span style='mso-tab-count:1'>&nbsp;&nbsp; </span>b8
  78 00 00 00<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mov<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>$0x78,%eax<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c0107526:<span style='mso-tab-count:1'>&nbsp;&nbsp; </span>53<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'>&nbsp; </span>push<span
  style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span style='mso-tab-count:1'> </span>%ebx<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c0107527:<span style='mso-tab-count:1'>&nbsp;&nbsp; </span>8b
  <st1:chmetcnv TCSC="0" NumberType="1" Negative="False" HasSpace="False"
  SourceValue="5" UnitName="C" w:st="on">5c</st1:chmetcnv> 24 14<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'> </span>mov<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>0x14(%esp,1),%ebx<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c010752b:<span style='mso-tab-count:1'>&nbsp;&nbsp; </span>8b
  <st1:chmetcnv TCSC="0" NumberType="1" Negative="False" HasSpace="False"
  SourceValue="4" UnitName="C" w:st="on">4c</st1:chmetcnv> 24 <st1:chmetcnv
  TCSC="0" NumberType="1" Negative="False" HasSpace="False" SourceValue="0"
  UnitName="C" w:st="on">0c</st1:chmetcnv><span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'> </span>mov<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>0xc(%esp,1),%ecx<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c<st1:chmetcnv TCSC="0" NumberType="1"
  Negative="False" HasSpace="False" SourceValue="10752" UnitName="F" w:st="on">010752f</st1:chmetcnv>:<span
  style='mso-tab-count:1'>&nbsp;&nbsp; </span>8b 54 24 10<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'> </span>mov<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>0x10(%esp,1),%edx<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c0107533:<span style='mso-tab-count:1'>&nbsp;&nbsp; </span>81
  cb 00 01 00 00<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>or<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='mso-tab-count:1'>&nbsp; </span>$0x100,%ebx<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c0107539:<span style='mso-tab-count:1'>&nbsp;&nbsp; </span>89
  e6<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'> </span>mov<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>%esp,%esi<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:blue'>c010753b:<span style='mso-tab-count:
  1'>&nbsp;&nbsp; </span>cd 80<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'> </span>int<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
  1'> </span><span style='color:blue'>$0x80<o:p></o:p></span></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c010753d:<span style='mso-tab-count:1'>&nbsp;&nbsp; </span>39
  e6<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'> </span>cmp<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>%esp,%esi<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c<st1:chmetcnv TCSC="0" NumberType="1"
  Negative="False" HasSpace="False" SourceValue="10753" UnitName="F" w:st="on">010753f</st1:chmetcnv>:<span
  style='mso-tab-count:1'>&nbsp;&nbsp; </span>74 <st1:chmetcnv TCSC="0"
  NumberType="1" Negative="False" HasSpace="False" SourceValue="0" UnitName="C"
  w:st="on">0c</st1:chmetcnv><span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
  style='mso-tab-count:1'> </span>je<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='mso-tab-count:1'>&nbsp; </span>c010754d &lt;kernel</span><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New"'>_</span><span style='font-size:9.0pt;font-family:"Courier New"'>thread+0x2d&gt;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c0107541:<span style='mso-tab-count:1'>&nbsp;&nbsp; </span>89
  d0<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'> </span>mov<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>%edx,%eax<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c0107543:<span style='mso-tab-count:1'>&nbsp;&nbsp; </span>50<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'>&nbsp; </span>push<span
  style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span style='mso-tab-count:1'> </span>%eax<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c0107544:<span style='mso-tab-count:1'>&nbsp;&nbsp; </span>ff
  d1<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'> </span>call<span
  style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span style='mso-tab-count:1'> </span>*%ecx<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c0107546:<span style='mso-tab-count:1'>&nbsp;&nbsp; </span>b8
  01 00 00 00<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mov<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>$0x1,%eax<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c010754b:<span style='mso-tab-count:1'>&nbsp;&nbsp; </span>cd
  80<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
  style='mso-tab-count:1'> </span>int<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>$0x80<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c010754d:<span style='mso-tab-count:1'>&nbsp;&nbsp; </span>5b<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'>&nbsp; </span>pop<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>%ebx<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c010754e:<span style='mso-tab-count:1'>&nbsp;&nbsp; </span>5e<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'>&nbsp; </span>pop<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>%esi<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c<st1:chmetcnv TCSC="0" NumberType="1"
  Negative="False" HasSpace="False" SourceValue="10754" UnitName="F" w:st="on">010754f</st1:chmetcnv>:<span
  style='mso-tab-count:1'>&nbsp;&nbsp; </span>c3<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'>&nbsp; </span>ret <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>......<span style='mso-tab-count:1'>&nbsp; </span><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:red'>c<st1:chmetcnv TCSC="0" NumberType="1"
  Negative="False" HasSpace="False" SourceValue="25" UnitName="C" w:st="on">025c</st1:chmetcnv>7e0
  &lt;start</span><span style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:red'>_</span><span style='font-size:
  9.0pt;font-family:"Courier New";color:red'>kernel&gt;:<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>......</span><span
  style='font-size:9.0pt;font-family:"Courier New"'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c<st1:chmetcnv TCSC="0" NumberType="1"
  Negative="False" HasSpace="False" SourceValue="25" UnitName="C" w:st="on">025c</st1:chmetcnv>8fa:<span
  style='mso-tab-count:1'>&nbsp;&nbsp; </span>e<st1:chmetcnv TCSC="0"
  NumberType="1" Negative="False" HasSpace="True" SourceValue="8" UnitName="C"
  w:st="on">8 c</st1:chmetcnv>1 fe ff ff<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'><span
  style='mso-tab-count:1'>&nbsp; </span></span><span style='font-size:9.0pt;
  font-family:"Courier New"'>call<span style='mso-spacerun:yes'>&nbsp;&nbsp;
  </span>c<st1:chmetcnv TCSC="0" NumberType="1" Negative="False"
  HasSpace="False" SourceValue="25" UnitName="C" w:st="on">025c</st1:chmetcnv><st1:chmetcnv
  TCSC="0" NumberType="1" Negative="False" HasSpace="False" SourceValue="7"
  UnitName="C" w:st="on">7c</st1:chmetcnv>0 &lt;smp</span><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New"'>_</span><span style='font-size:9.0pt;font-family:"Courier New"'>init&gt;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c<st1:chmetcnv TCSC="0" NumberType="1"
  Negative="False" HasSpace="False" SourceValue="25" UnitName="C" w:st="on">025c</st1:chmetcnv>8ff:<span
  style='mso-tab-count:1'>&nbsp;&nbsp; </span>68 00 0e 01 00<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='mso-tab-count:1'> </span>push<span
  style='mso-spacerun:yes'>&nbsp;&nbsp; </span>$0x10e00<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c<st1:chmetcnv TCSC="0" NumberType="1"
  Negative="False" HasSpace="False" SourceValue="25" UnitName="C" w:st="on">025c</st1:chmetcnv>904:<span
  style='mso-tab-count:1'>&nbsp;&nbsp; </span><st1:chmetcnv TCSC="0"
  NumberType="1" Negative="False" HasSpace="False" SourceValue="6" UnitName="a"
  w:st="on">6a</st1:chmetcnv> 00<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'>&nbsp; </span>push<span
  style='mso-spacerun:yes'>&nbsp;&nbsp; </span>$0x0<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c<st1:chmetcnv TCSC="0" NumberType="1"
  Negative="False" HasSpace="False" SourceValue="25" UnitName="C" w:st="on">025c</st1:chmetcnv>906:<span
  style='mso-tab-count:1'>&nbsp;&nbsp; </span>68 00 70 <st1:chmetcnv TCSC="0"
  NumberType="1" Negative="False" HasSpace="True" SourceValue="10" UnitName="C"
  w:st="on">10 c</st1:chmetcnv>0<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'>&nbsp; </span>push<span style='mso-spacerun:yes'>&nbsp;&nbsp;
  </span>$0xc0107000<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c<st1:chmetcnv TCSC="0" NumberType="1"
  Negative="False" HasSpace="False" SourceValue="25" UnitName="C" w:st="on">025c</st1:chmetcnv>90b:<span
  style='mso-tab-count:1'>&nbsp;&nbsp; </span>e8 <st1:chmetcnv TCSC="0"
  NumberType="1" Negative="False" HasSpace="True" SourceValue="10" UnitName="ac"
  w:st="on">10 ac</st1:chmetcnv> ea ff<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'>&nbsp; </span>call<span style='mso-spacerun:yes'>&nbsp;&nbsp;
  </span>c0107520 &lt;kernel</span><span style='font-size:9.0pt;font-family:
  "Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New"'>_</span><span
  style='font-size:9.0pt;font-family:"Courier New"'>thread&gt;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>......<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>一步步的看吧，这里关于内核汇编语法这里就不多解释了，在到达</span>int
0x80<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>时，父进程的堆栈如下：</span></p>

<p class=MsoNormalIndent align=center style='text-align:center'><!--[if gte vml 1]><v:shapetype
 id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t"
 path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style='width:199.5pt;
 height:153pt' o:ole="">
 <v:imagedata src="503_files/image002.emz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=266 height=204
src="503_files/image003.gif" v:shapes="_x0000_i1025"><![endif]><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Visio.Drawing.11" ShapeID="_x0000_i1025"
  DrawAspect="Content" ObjectID="_1575099340">
 </o:OLEObject>
</xml><![endif]--></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>当进入</span>int 0x80<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>并经过</span><span style='font-size:9.0pt;
font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>copy</span><span
style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
"Courier New";color:#880000;mso-font-kerning:0pt'>_</span><span
style='font-size:9.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
0pt'>thread</span><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数后，父子进程的堆栈如下：</span></p>

<p class=MsoNormalIndent><!--[if gte vml 1]><v:shape id="_x0000_i1026" type="#_x0000_t75"
 style='width:366.75pt;height:365.25pt' o:ole="">
 <v:imagedata src="503_files/image004.emz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=489 height=487
src="503_files/image005.gif" v:shapes="_x0000_i1026"><![endif]><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Visio.Drawing.11" ShapeID="_x0000_i1026"
  DrawAspect="Content" ObjectID="_1575099342">
 </o:OLEObject>
</xml><![endif]--></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>这里我们需要注意一下几点：</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l12 level1 lfo3;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]><span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>注意如果运行级别没有发生改变，</span>CPU<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>不会进行堆栈切换，即</span>interrupt stack-frame
pushes<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>：</span>SS:ESP is pushed only on a CPL
change. In compatibility mode, IRET pops SS:ESP off the stack only if there is
a CPL change.</p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l12 level1 lfo3;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]><span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>而这里，由于在内核中调用了</span>int
0x80<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，</span>CPU<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>不会压入</span>SS:ESP<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，故在复制</span>pt_regs<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>时，只好将父进程的</span>ESI/EBX<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>复制过来填补</span>SS:ESP<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>了，并且将</span>EBX<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>设置成</span>fn<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，这里</span>ESI/EBX<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>只是候补垫背，并没有起到任何作用。而子进程在退出后，并不会改变</span>SS:ESP<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，而是继续使用自己的系统栈。</span></p>

<p class=MsoNormalIndent style='margin-left:21.0pt;text-indent:0cm;mso-char-indent-count:
0'><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>当子进程从</span>int 0x80<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>返回后，其堆栈如下：</span></p>

<p class=MsoNormalIndent align=center style='text-align:center'><!--[if gte vml 1]><v:shape
 id="_x0000_i1027" type="#_x0000_t75" style='width:240pt;height:193.5pt' o:ole="">
 <v:imagedata src="503_files/image006.emz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=320 height=258
src="503_files/image007.gif" v:shapes="_x0000_i1027"><![endif]><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Visio.Drawing.11" ShapeID="_x0000_i1027"
  DrawAspect="Content" ObjectID="_1575099343">
 </o:OLEObject>
</xml><![endif]--></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>我们在</span>kernel_thread<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>继续往下看：</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:80.95pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#E6E6E6;padding:0cm 5.4pt 0cm 5.4pt;
  height:80.95pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>......<span style='mso-tab-count:1'>&nbsp; </span><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:red'>c0107520 &lt;kernel</span><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:red'>_</span><span style='font-size:9.0pt;font-family:
  "Courier New";color:red'>thread&gt;:<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:silver'>c0107520:<span style='mso-tab-count:
  1'>&nbsp;&nbsp; </span>56<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'>&nbsp; </span>push<span
  style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span style='mso-tab-count:1'> </span>%esi<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:silver'>c0107521:<span style='mso-tab-count:
  1'>&nbsp;&nbsp; </span>b8 78 00 00 00<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mov<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>$0x78,%eax<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:silver'>c0107526:<span style='mso-tab-count:
  1'>&nbsp;&nbsp; </span>53<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'>&nbsp; </span>push<span
  style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span style='mso-tab-count:1'> </span>%ebx<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:silver'>c0107527:<span style='mso-tab-count:
  1'>&nbsp;&nbsp; </span>8b <st1:chmetcnv TCSC="0" NumberType="1"
  Negative="False" HasSpace="False" SourceValue="5" UnitName="C" w:st="on">5c</st1:chmetcnv>
  24 14<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'> </span>mov<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>0x14(%esp,1),%ebx<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:silver'>c010752b:<span style='mso-tab-count:
  1'>&nbsp;&nbsp; </span>8b <st1:chmetcnv TCSC="0" NumberType="1"
  Negative="False" HasSpace="False" SourceValue="4" UnitName="C" w:st="on">4c</st1:chmetcnv>
  24 <st1:chmetcnv TCSC="0" NumberType="1" Negative="False" HasSpace="False"
  SourceValue="0" UnitName="C" w:st="on">0c</st1:chmetcnv><span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'> </span>mov<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>0xc(%esp,1),%ecx<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:silver'>c<st1:chmetcnv TCSC="0" NumberType="1"
  Negative="False" HasSpace="False" SourceValue="10752" UnitName="F" w:st="on">010752f</st1:chmetcnv>:<span
  style='mso-tab-count:1'>&nbsp;&nbsp; </span>8b 54 24 10<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'> </span>mov<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>0x10(%esp,1),%edx<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:silver'>c0107533:<span style='mso-tab-count:
  1'>&nbsp;&nbsp; </span>81 cb 00 01 00 00<span
  style='mso-spacerun:yes'>&nbsp;&nbsp; </span>or<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='mso-tab-count:1'>&nbsp; </span>$0x100,%ebx<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:silver'>c0107539:<span style='mso-tab-count:
  1'>&nbsp;&nbsp; </span>89 e6<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'> </span>mov<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>%esp,%esi<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:silver'>c010753b:<span style='mso-tab-count:
  1'>&nbsp;&nbsp; </span>cd 80<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'> </span>int<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>$0x80<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c010753d:<span style='mso-tab-count:1'>&nbsp;&nbsp; </span>39
  e6<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'> </span>cmp<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>%esp,%esi<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c<st1:chmetcnv TCSC="0" NumberType="1"
  Negative="False" HasSpace="False" SourceValue="10753" UnitName="F" w:st="on">010753f</st1:chmetcnv>:<span
  style='mso-tab-count:1'>&nbsp;&nbsp; </span>74 <st1:chmetcnv TCSC="0"
  NumberType="1" Negative="False" HasSpace="False" SourceValue="0" UnitName="C"
  w:st="on">0c</st1:chmetcnv><span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'> </span>je<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='mso-tab-count:1'>&nbsp; </span>c010754d &lt;kernel</span><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New"'>_</span><span style='font-size:9.0pt;font-family:"Courier New"'>thread+0x2d&gt;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:green'>c0107541:<span style='mso-tab-count:
  1'>&nbsp;&nbsp; </span>89 d0<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'> </span>mov<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>%edx,%eax<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:green'>c0107543:<span style='mso-tab-count:
  1'>&nbsp;&nbsp; </span>50<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'>&nbsp; </span>push<span
  style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span style='mso-tab-count:1'> </span>%eax<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:green'>c0107544:<span style='mso-tab-count:
  1'>&nbsp;&nbsp; </span>ff d1<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'> </span>call<span
  style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span style='mso-tab-count:1'> </span>*%ecx<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:green'>c0107546:<span style='mso-tab-count:
  1'>&nbsp;&nbsp; </span>b8 01 00 00 00<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mov<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>$0x1,%eax<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:green'>c010754b:<span style='mso-tab-count:
  1'>&nbsp;&nbsp; </span>cd 80<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'> </span>int<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>$0x80<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c010754d:<span style='mso-tab-count:1'>&nbsp;&nbsp; </span>5b<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'>&nbsp; </span>pop<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>%ebx<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c010754e:<span style='mso-tab-count:1'>&nbsp;&nbsp; </span>5e<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-tab-count:1'>&nbsp; </span>pop<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
  1'> </span>%esi<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>c<st1:chmetcnv TCSC="0" NumberType="1"
  Negative="False" HasSpace="False" SourceValue="10754" UnitName="F" w:st="on">010754f</st1:chmetcnv>:<span
  style='mso-tab-count:1'>&nbsp;&nbsp; </span>c3<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
  style='mso-tab-count:1'>&nbsp; </span>ret <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New"'>......<span style='mso-tab-count:1'>&nbsp; </span><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>当从</span>int 0x80<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>返回后，如果是父进程（</span><span lang=ZH-CN
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>对于父进程从系统调用中如何退出这里不再多说</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>），则</span>esp<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和原先保存在</span>esi<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>中的</span>esp<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>一定是相等的，故跳到</span>c010754d<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>处执行，也就是从</span>kernel_thread<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>函数中退出，最终返回到</span>start_kernel<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>继续往下执行；</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>如果是子进程（注意，父子进程的</span>CS:EIP<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>完全相等，故返回后也会走到这里），很显然此时子进程的</span>esp<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>指向自己的系统空间栈，而</span>esi<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中保存的父进程的系统空间栈，两者是不相等的，故可以判断是子进程，然后将原来保存在</span>EDX<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中的参数压入堆栈，准备进行</span>fn<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>函数调用，也就是</span>init<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数调用，进入</span>init<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数时，子进程的系统空间栈为：</span></p>

<p class=MsoNormalIndent align=center style='text-align:center'><!--[if gte vml 1]><v:shape
 id="_x0000_i1028" type="#_x0000_t75" style='width:215.25pt;height:193.5pt'
 o:ole="">
 <v:imagedata src="503_files/image008.emz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=287 height=258
src="503_files/image009.gif" v:shapes="_x0000_i1028"><![endif]><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Visio.Drawing.11" ShapeID="_x0000_i1028"
  DrawAspect="Content" ObjectID="_1575099344">
 </o:OLEObject>
</xml><![endif]--></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>随后开始执行</span>init<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>函数的内部内容，当从</span>init<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数中返回时，模拟调用</span>sys_exit<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，进程自行消亡。</span></p>

<h1 style='mso-list:l24 level1 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>2
</span></span><![endif]>do_fork<span lang=ZH-CN style='font-family:黑体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的实现</span></h1>

<h2 style='mso-list:l24 level2 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:Arial;mso-bidi-font-family:Arial'><span
style='mso-list:Ignore'>2.1 </span></span><![endif]><span lang=ZH-CN
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>信号量</span>(semaphore)</h2>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>首先我们介绍下信号量，因为下面要用到。</span>Linux<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>内核信号量在创建时需要设置一个初始值，表示同时可以有几个任务可以访问该信号量保护的共享资源，初始值为</span>1<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>就变成互斥锁（</span>Mutex<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>），即同时只能有一个任务可以访问信号量保护的共享资源。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>一个任务要想访问共享资源，首先必须得到信号量，<span
style='background:lime;mso-highlight:lime'>获取信号量的操作将把信号量的值减</span></span><span
style='background:lime;mso-highlight:lime'>1</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:lime;mso-highlight:lime'>，</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>若减去</span>1<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>后当前信号量的值为负数，表明无法获得信号量，该任务必须挂起在该信号量的等待队列等待该信号量可用；若减去</span>1<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>后当前信号量的值为非负数，表示可以获得信号量，因而可以立刻访问被该信号量保护的共享资源。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>当任务访问完被信号量保护的共享资源后，必须释放信号量，释放信号量通过把信号量的值加</span>1<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>实现，如果信号量的值为非正数，表明有任务等待当前信号量，因此它也唤醒所有等待该信号量的任务。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>信号量的</span>API<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>有：</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l28 level1 lfo5;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>DECLARE_MUTEX(name)<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>：该宏声明一个信号量</span>name<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>并初始化它的值为</span>1<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，即声明一个互斥锁。</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l28 level1 lfo5;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>DECLARE_MUTEX_LOCKED(name)<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>：该宏声明一个互斥锁</span>name<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，但把它的初始值设置为</span>0<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，即锁在创建时就处在已锁状态。因此对于这种锁，一般是先释放后获得。</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l28 level1 lfo5;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings;color:red'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]><span style='color:red'>void sema_init (struct
semaphore *sem, int val)</span><span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>：该函用于数初始化设置信号量的初值，它设置信号量</span><span style='color:red'>sem</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>的值为</span><span
style='color:red'>val</span><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>。</span><span
style='color:red'><o:p></o:p></span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l28 level1 lfo5;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>void init_MUTEX (struct semaphore *sem)<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>：该函数用于初始化一个互斥锁，即它把信号量</span>sem<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的值设置为</span>1<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l28 level1 lfo5;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>void init_MUTEX_LOCKED (struct semaphore *sem)<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>：该函数也用于初始化一个互斥锁，但它把信号量</span>sem<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的值设置为</span>0<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，即一开始就处在已锁状态。</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l28 level1 lfo5;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>void down(struct semaphore * sem)<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>：该函数用于获得信号量</span>sem<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，它会导致睡眠，因此不能在中断上下文（包括</span>IRQ<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>上下文和</span>softirq<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>上下文）使用该函数。该函数将把</span>sem<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的值减</span>1<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，如果信号量</span>sem<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的值非负，就直接返回，否则调用者将被挂起，直到别的任务释放该信号量才能继续运行。</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l28 level1 lfo5;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>void up(struct semaphore * sem)<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>：该函数释放信号量</span>sem<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，即把</span>sem<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的值加</span>1<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，如果</span>sem<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的值为非正数，表明有任务等待该信号量，因此唤醒这些等待者。</span></p>

<h2 style='mso-list:l24 level2 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:Arial;mso-bidi-font-family:Arial'><span
style='mso-list:Ignore'>2.2 </span></span><![endif]>do_fork<span lang=ZH-CN
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>讲解</span>(1)</h2>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>首先我们来看看</span>do_fork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的代码：</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:83.5pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#E6E6E6;padding:0cm 5.4pt 0cm 5.4pt;
  height:83.5pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'>do</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:red;mso-font-kerning:0pt'>_</span></b><b
  style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;font-family:
  "Courier New";color:red;mso-font-kerning:0pt'>fork :<o:p></o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>555 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>int</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>do</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>fork</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>(</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>unsigned</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>long</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>clone</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>flags</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>, </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>unsigned</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>long</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>stack</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>start</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>,<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>556<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>struct</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> pt</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>regs *</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>regs</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>, </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>unsigned</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>long</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>stack</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>size</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>557 {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>558<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>int</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>retval</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> = -</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>ENOMEM</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>559<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>struct</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> task</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>struct *</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>p</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>560<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;
  </span>DECLARE</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>MUTEX</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>LOCKED(sem);</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent>560<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>行申明了互斥锁</span>sem<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，初始值为</span>0<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，该变量主要用于</span>vfork<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，我们知道</span>vfork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>创建的子进程和父进程使用共同的用户空间堆栈，为了防止同时操作堆栈导致的不可预知的错误，就必须仅仅允许该堆栈同时只允许一个进程操作，</span>Linux<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>采用这样的策略，就是在子进程退出或者执行</span>exec<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>之前，让父进程休眠，这样此段时间堆栈子进程独自操作。在子进程退出或执行</span>exec<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>那时刻再唤醒父进程，此时子进程已经消亡了，故堆栈只有父进程独自操作。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>那么</span>Linux<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>是如何实现这种策略的呢？那就是在父进程执行</span>sys_vfork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>时，首先申明信号量</span>sem=0<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，随后创建子进程。父进程会继续沿着系统空间的执行路线往下走，执行</span>down(&amp;sem)<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>导致</span>sem<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>减</span>1<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>变为负，故父进程进入睡眠状态，调度程序开始执行。当调度到子进程时，由于父进程还在睡眠中，故子进程是独占用户空间堆栈的。直到当子进程退出或者执行</span>exec<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>时执行</span>up(tsk-&gt;p_opptr-&gt;vfork_sem)<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，导致</span>sem<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>加</span>1<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>重新变成</span>0<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，唤醒父进程进入运行状态，此时用户空间堆栈为父进程独占，因为刚刚</span>vfork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>出的子进程已经消亡了。可见，整个过程保证了父子进程共用的用户空间堆栈不会被父子进程同时使用。</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:87.35pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#E6E6E6;padding:0cm 5.4pt 0cm 5.4pt;
  height:87.35pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'>do</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:red;mso-font-kerning:0pt'>_</span></b><b
  style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;font-family:
  "Courier New";color:red;mso-font-kerning:0pt'>fork :<o:p></o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>561 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>562<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (clone</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>flags &amp; </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>CLONE</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:gray;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>PID</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>) {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>563<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#009900;mso-font-kerning:0pt'>/* This is only
  allowed from the boot up thread */</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>564<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='mso-spacerun:yes'>&nbsp;</span></span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>if</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> (</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>current</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;pid)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>565<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>return</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> -</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>EPERM</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>566<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>567</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>在</span>fork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>进程的时候，可以让父进程和子进程使用同一个</span>PID<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，只要在调用</span>do_fork<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>时候给</span>clone_flags<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>参数传递</span>CLONE_PID<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>标识就可以了，但是</span>Linux<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>内核只允许父进程为</span>0<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>号进程时才可以这样做。这里就是针对这种情况进行检查，如果发现</span>clone_flags<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>包含</span>CLONE_PID<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>标志，但是当前进程不是</span>0<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>号进程，则返回失败，如果是继续往下处理。在下面调用</span>get_pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>为子进程分配</span>pid<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>时，如果发</span>CLONE_PID<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>标志，则直接返回父进程的</span>pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>作为子进程的</span>pid<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:89.45pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#E6E6E6;padding:0cm 5.4pt 0cm 5.4pt;
  height:89.45pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'>do</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:red;mso-font-kerning:0pt'>_</span></b><b
  style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;font-family:
  "Courier New";color:red;mso-font-kerning:0pt'>fork :<o:p></o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>568<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>current</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;vfork</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>sem = &amp;sem;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>569 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>570<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> = alloc</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>task</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>struct();<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>571<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (!</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>p</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>572<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>goto</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>fork</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>out</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>573 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>574<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>*</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> = *</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>current</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>首先将当前的局部变量</span>sem<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>地址保存到当前进程</span>----<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>父进程的</span>vfork_sem<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>中，当</span>do_fork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>是因为</span>sys_vfork<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>而调用的时候，父进程在该函数中随后会调用</span>down(&amp;sem)<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>进入休眠并引起调度，此时</span>sem<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>保存在父进程的系统堆栈中。当调度激活子进程时，子进程通过</span>tsk-&gt;p_opptr<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>找到父进程，然后准备唤醒父进程，而唤醒只能够通过</span>sem<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>来唤醒，那么子进程如何访问到父进程的局部变量</span>sem<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>呢？就是通过刚刚保存在</span>vfork_sem<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中的</span>sem<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>指针，从而调用</span>up(tsk-&gt;p_opptr-&gt;vfork_sem)<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>唤醒父进程。另外需要说明的是，由于此时父进程还在睡眠中并且睡眠前并没有退出声明</span>sem<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>局部变量的函数，故父进程保存在系统堆栈中的</span>sem<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在被唤醒前依然有效。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>随后为子进程的系统堆栈及</span>tsk<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>分配</span>2<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个物理页面（关于系统堆栈及</span>tsk<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>为何占用两个页面这里不再多说）。</span>574<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>行将父进程的</span>task_struct<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结构完全复制到子进程的</span>task_struct<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中，注意</span>p<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>为</span>struct task_struct*<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>结构，这种指针赋值的方式在编译后是以</span>memcpy<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>实现的。</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:154.15pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#E6E6E6;padding:0cm 5.4pt 0cm 5.4pt;
  height:154.15pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'>do</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:red;mso-font-kerning:0pt'>_</span></b><b
  style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;font-family:
  "Courier New";color:red;mso-font-kerning:0pt'>fork :<o:p></o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>575 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>576<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>retval
  = -</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:
  "Courier New";color:#A000A0;mso-font-kerning:0pt'>EAGAIN</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>577<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (atomic</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>read(&amp;</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>p</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;user-&gt;processes) &gt;= </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;rlim[RLIMIT</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>NPROC].rlim</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>cur)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>578<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>goto</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>bad</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>fork</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>free</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>579<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>atomic</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>inc(&amp;</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;
  mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>-&gt;user-&gt;</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>__</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>count);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>580<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>atomic</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>inc(&amp;</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;
  mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>-&gt;user-&gt;processes);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>581 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>582<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#009900;mso-font-kerning:0pt'>/*<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>583<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>* Counter increases are protected by<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>584<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>* the kernel lock so nr</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:#009900;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>threads can't<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>585<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>* increase under us (but it may decrease).<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>586<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>*/</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>587<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (nr</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>threads &gt;= max</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>threads)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>588<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>goto</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>bad</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>fork</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>cleanup</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>count</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>; </span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent>tsk<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>结构中有个指针</span>user<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，指明当前进程所属的用户，一个用户可以拥有多个进程，而这些进程就通过该指针指向该用户对应的结构</span>user_struct<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。注意内核线程并不属于某个用户，故内核为内核线程创建了个虚拟用户</span>root_user<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>每当父进程创建一个子进程时，就会将父进程所在的用户当前拥有的进程数量</span>user_stuct-&gt;
processes<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>加</span>1<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，如</span>580<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>行所示，这样</span>user_stuct-&gt;
processes<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>就表示当前用户拥有的进程数量。每个用户拥有的进程数量是有限制的，该限制数量是在系统初始化时</span>fork_init<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中确定，其依据物理内存内存的大小计算出一个值作为标准。如下所示：</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:116.0pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#CCFFCC;padding:0cm 5.4pt 0cm 5.4pt;
  height:116.0pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>66 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>void</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:black;mso-font-kerning:0pt'>__</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>init </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>fork</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>init</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>(</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>unsigned</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>long</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>mempages</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>67 {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>68<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#009900;mso-font-kerning:0pt'>/*<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>69<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>*
  The default maximum number of threads is set to a safe<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>70<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>*
  value: the thread structures can take up at most half<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>71<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>*
  of memory.<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>72<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;</span>*/</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>73<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>max</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>threads = </span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;
  mso-font-kerning:0pt'>mempages</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'> / (THREAD</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>SIZE/PAGE</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>SIZE) / 2;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>74 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>75<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>init</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>task.rlim[RLIMIT</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>NPROC].rlim</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>cur = max</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>threads/2;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>76<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>init</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>task.rlim[RLIMIT</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>NPROC].rlim</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>max = max</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>threads/2;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>77 }</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent>max_threads<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>表示当前系统可运行的最大进程数目，从</span>fork_init<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>可以看出每个用户同时拥有的最大进程为</span>max_threads/2<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。<span style='background:yellow;
mso-highlight:yellow'>这里需要说明一点的是，如果按照</span></span><span style='background:
yellow;mso-highlight:yellow'>X86 CPU</span><span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
background:yellow;mso-highlight:yellow'>的进程实现方法，则进程的最大数量就不是由软件来决定的了，按照</span><span
style='background:yellow;mso-highlight:yellow'>X86 CPU</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:yellow;mso-highlight:yellow'>的方法，每个进程都必须在</span><span
style='background:yellow;mso-highlight:yellow'>GDT</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:yellow;mso-highlight:yellow'>中占用一条表项，而</span><span
style='background:yellow;mso-highlight:yellow'>GDT</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:yellow;mso-highlight:yellow'>表项是通过段选择符</span><span
style='background:yellow;mso-highlight:yellow'>----</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:yellow;mso-highlight:yellow'>一个</span><span
style='background:yellow;mso-highlight:yellow'>16bit</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:yellow;mso-highlight:yellow'>的高</span><span
style='background:yellow;mso-highlight:yellow'>13</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:yellow;mso-highlight:yellow'>位来索引到，而</span><span
style='background:yellow;mso-highlight:yellow'>13bit</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:yellow;mso-highlight:yellow'>最大索引范围为</span><span
style='background:yellow;mso-highlight:yellow'>2^13=8192</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";background:yellow;mso-highlight:yellow'>，故</span><span
style='background:yellow;mso-highlight:yellow'>GDT</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:yellow;mso-highlight:yellow'>的最大表项数目为</span><span
style='background:yellow;mso-highlight:yellow'>8192</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:yellow;mso-highlight:yellow'>，由于系统需要使用</span><span
style='background:yellow;mso-highlight:yellow'>12</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:yellow;mso-highlight:yellow'>条，这样还剩余</span><span
style='background:yellow;mso-highlight:yellow'>8180</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:yellow;mso-highlight:yellow'>条表项可用，由于每个进程的</span><span
style='background:yellow;mso-highlight:yellow'>LDT</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:yellow;mso-highlight:yellow'>还要占用</span><span
style='background:yellow;mso-highlight:yellow'>1</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:yellow;mso-highlight:yellow'>条</span><span
style='background:yellow;mso-highlight:yellow'>GDT</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:yellow;mso-highlight:yellow'>表项，也就是说每个进程需要占用</span><span
style='background:yellow;mso-highlight:yellow'>GDT</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:yellow;mso-highlight:yellow'>中的两条表项，故按</span><span
style='background:yellow;mso-highlight:yellow'>X86 CPU</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:yellow;mso-highlight:yellow'>的进程实现方法，最大可支持进程数目为</span><span
style='background:yellow;mso-highlight:yellow'>8180/2=4090</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";background:yellow;mso-highlight:yellow'>。</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>但是</span>Linux<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>并没有使用</span>X86 CPU<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的进程实现方法，而是采用了自己的独立设计，故不会受此约束，其最大进程数目约束是由物理内存大小决定的，如上所述。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>继续上面的</span>do_fork
577<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>行往下看，如果发现当前用户的进程数目已经大于设定的上限，则返回失败。</span>579<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>行增加对该用户的引用计数</span>user-&gt;__count<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span>user-&gt;__count<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>表示当前用户被引用的计数），创建一个子进程就相当于给当前用户增加了一个引用，另外通过</span>setuid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>命令还可以将一个进程从所属的用户移动到另一个用户中，此时就会递减老用户的</span>user-&gt;__count<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，同时增加新用户的</span>user-&gt;__count<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。</span>580<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>行递增当前用户拥有的进程数目。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>在创建一个子进程前，还必须保证系统当前进程数目不能超过当前系统可运行的最大进程数目。</span>587<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>行就是起到了这个判断作用。</span>nr_threads<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>表示系统当前进程数目，每当</span>do_fork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>成功创建出一个子进程时，会递增</span>nr_threads<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。</span></p>

<h2 style='mso-list:l24 level2 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:Arial;mso-bidi-font-family:Arial'><span
style='mso-list:Ignore'>2.3 </span></span><![endif]><span lang=ZH-CN
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>可执行文件加载概述</span></h2>

<p class=MsoNormalIndent>Linux<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>支持多种可执行文件格式，例如</span>a.out<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>、</span>ELF<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>、</span>em86<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>、</span>misc<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>、</span>script<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>等。可执行文件的头</span>4<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>个字节包含了特征码，其用来指名该文件是一个何种格式的可执行文件。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>内核用</span>struct
linux_binfmt<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>表示某种格式的可执行文件处理结构，该结构指明了如何处理该格式的可执行文件，内核支持的所有可执行文件处理结构都被链接在全局链表</span>formats<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中。一般某种格式的可执行文件处理结构及其处理方法都定义和实现在一个模块中，当插入该模块时，在模块的</span>module_init<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>初始化函数中会调用</span>register_binfmt<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>函数把自己的</span>linux_binfmt<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>处理结构挂到内核</span>formats<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>全局链表中，这就表示内核从现在起开始支持该种格式可执行文件的处理，例如</span>ELF<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>模块会将自己的</span>linux_binfmt<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结构</span>elf_format<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>注册到</span>formats<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>链表中。</span>struct
linux_binfmt<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结构如下：</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:86.15pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#CCFFCC;padding:0cm 5.4pt 0cm 5.4pt;
  height:86.15pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>struct</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>linux</span><span style='font-size:9.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>binfmt</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>struct</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>linux</span><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:blue;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>binfmt</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> * </span><span style='font-size:9.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>next</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>struct</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>module</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> *</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>module</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>int</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (*</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>load</span><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:gray;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>binary</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>)(</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>struct</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> linux</span><span style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>binprm *, </span><span style='font-size:9.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>struct</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-spacerun:yes'>&nbsp; </span>pt</span><span style='font-size:9.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>regs * </span><span
  style='font-size:9.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>regs</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>int</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (*</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>load</span><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:gray;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>shlib</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>)(</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>struct</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>file</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> *);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>int</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (*</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>core</span><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:gray;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>dump</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>)(</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>long</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>signr</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>, </span><span
  style='font-size:9.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>struct</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> pt</span><span style='font-size:9.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>regs * </span><span
  style='font-size:9.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>regs</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>, </span><span style='font-size:9.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>struct</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>file</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> * </span><span
  style='font-size:9.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>file</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>unsigned</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>long</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>min</span><span style='font-size:9.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>coredump</span><span
  style='font-size:9.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>;<span style='mso-tab-count:1'> </span></span><span style='font-size:
  9.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:0pt'>/*
  minimal dump size */</span><span style='font-size:9.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>};<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l28 level1 lfo5;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>next<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>用来将自己链入到全局队列</span>formats<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中；</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l28 level1 lfo5;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>module<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>用来指明自己所属的模块；</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l28 level1 lfo5;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>load_binary<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>通过读取可执行文件的内容为当前进程创建新的执行环境；</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l28 level1 lfo5;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>load_shlib<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>用来动态的将一个该可执行格式的共享库绑定到一个已经在运行的进程中。</span>uselib<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>系统调用会调用该函数；</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l28 level1 lfo5;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>core_dump<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>将当前进程的执行环境保存在名为</span>core<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>文件中，该文件的格式依赖于当前正在被执行的可执行文件的格式，通常当进程收到缺省处理行为为</span>core<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的信号时会调用该函数；</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l28 level1 lfo5;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>min_coredump<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>用来指明前面所说的</span>core<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的最小</span>size <span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>当某个进程执行</span>exec<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>执行一个新的程序时，内核依据传递过来的路径参数找到该可执行文件并加载其首部部分内容到内存缓冲区</span>bprm<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中。然后针对该内存缓冲区，依次调用全局链表</span>formats<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中每一个</span>linux_binfmt<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>成员的</span>load_binary(bprm, ...)<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>成员函数来分析它，包括特征码等等，如果分析失败，则表示该可执行文件非此种格式，随后继续下一个</span>linux_binfmt<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>成员，直到分析成功。如果所有的</span>linux_binfmt-&gt;load_binary<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>分析都不成功，则表示内核不支持该种格式的可执行文件，返回失败。如果分析成功，则将</span>tsk-&gt;
binfmt<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>指针指向该</span>linux_binfmt<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结构。</span></p>

<h2 style='mso-list:l24 level2 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:Arial;mso-bidi-font-family:Arial'><span
style='mso-list:Ignore'>2.4 </span></span><![endif]><span lang=ZH-CN
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>执行域</span>(Execution
Domains)</h2>

<h3 style='mso-list:l24 level3 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>2.4.1
</span></span><![endif]><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>执行域的起因</span></h3>

<p class=MsoNormalIndent>Linux<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>能够执行在其他操作系统上编译成的可执行文件，例如在</span>BSD<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>、</span>SOLARIS<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>、</span>SUNOS<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>等操作系统上编译的可执行文件，当然，前提必须保证该文件的二进制机器码和当前内核运行的计算机体系架构一样。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>该技术主要应用于</span>POSIX-compliant<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的操作系统。</span>BSD<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>、</span>System V Release 4(SVR4)<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>、</span>SOLARIS<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>、</span>SUNO<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>等这样的操作系统都是</span>POSIX<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>兼容的，也就是说他们的系统调用基本一致，这样在这里操作系统上编译出来的</span>POSIX-compliant<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>程序在</span>Linux<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>上运行基本上就没多大问题了。需要注意的是，虽然说他们的系统调用基本一致，但是还是会存在稍许不同的，这些不同主要包括：系统调用方式不同和信号编号方式不同。举例说明：我们已经知道有多种格式的可执行程序，而每种格式的可执行程序又可能是在不同的操作系统上编译的，例如把在</span>SVR4<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>上编译的</span>ELF<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>可执行文件复制到</span>Linux<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>上运行，由于</span>SVR4<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>和</span>Linux<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>都完全遵循</span>EFL<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>规范，故</span>Linux<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>能够解释加载该</span>ELF<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>可执行文件，但是像前面所述，由于</span>SVR4<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和</span>Linux<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>在系统调用以及信号编号方式上的不同，</span>Linux<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在执行该文件的时候可能会出现很多意料不到的问题。那么</span>Linux<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>是如何解决这个问题的呢？</span></p>

<h3 style='mso-list:l24 level3 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>2.4.2
</span></span><![endif]><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>执行域结构</span>exec_domain</h3>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>内核用</span>struct exec_domain<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结构（<span style='background:yellow;
mso-highlight:yellow'>也称执行域</span>）表示某操作系统编译的可执行文件在</span>Linux<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中的处理方法。这些结构都被链接在全局链表</span>exec_domains<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中，该结构如下：</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:91.55pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#CCFFCC;padding:0cm 5.4pt 0cm 5.4pt;
  height:91.55pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>struct</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>exec</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:blue;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>domain</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>const</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>char</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> *</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>name</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>lcall7</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>func </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>handler</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>unsigned</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>char</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>pers</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>low</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>, </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>pers</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:
  "Courier New";color:gray;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>high</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>unsigned</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>long</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> * </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>signal</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>map</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>unsigned</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>long</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> * </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>signal</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;mso-bidi-font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>invmap</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>struct</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>module</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> * </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>module</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>struct</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>exec</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  mso-bidi-font-family:"Courier New";color:blue;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>domain</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> *</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>next</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>};<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent style='margin-left:21.0pt;text-indent:0cm;mso-char-indent-count:
0'><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l28 level1 lfo5;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>name<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>为本执行域对应的操作系统名称，例如</span>Linux<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>；</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l28 level1 lfo5;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>handler<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>和</span>signal_map<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>用意不详，这里不做说明；</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l28 level1 lfo5;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>pers_low<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>和</span>pers_high<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>构成了一个区间</span>[pers_low, pers_high]<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，表示该执行域对应的</span>personality<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>值范围，进程在依据</span>personality<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>查找</span>exec_domain<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>时，就是依据该区间来判断的，注意该区间的最大范围为</span>0-255<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，因为其为</span>char<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>型；</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l28 level1 lfo5;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>signal_invmap<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>就是该执行域的信号编号方式；</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l28 level1 lfo5;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>next<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>用来将自己链入到全局队列</span>exec_domains<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中；</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>进程加载程序在分析可执行文件格式时，会依据该文件内容设置该进程的</span>task_struct-&gt;personality<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>值，然后依据该值和</span>exec_domains<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>链表中的每一个</span>exec_domain<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>成员的</span>pers_low<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>、</span>pers_high<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>比较，如果该值在</span>pers_low<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>、</span>pers_high<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>组成的区间内，则就认为该</span>exec_domain<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>就是我们要找的执行域。</span></p>

<h3 style='mso-list:l24 level3 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>2.4.3
</span></span><![endif]>personality</h3>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>进程的</span>task_struct-&gt;personality<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>值只是用于表明该进程对应的可执行文件的执行域，但是该执行域的相关处理模块是否加载或</span>Linux<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>是否支持，还要从</span>exec_domains<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>链表中查找才能得以知道。</span>Linux<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>目前支持的预定义</span>personality<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>值如下表（注意，每个值对应的</span>exec_domain<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>并不一定已经加载）：</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:167.3pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#CCFFCC;padding:0cm 5.4pt 0cm 5.4pt;
  height:167.3pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>#define </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>PER</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#A000A0;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>MASK</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(0x00ff)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>#define </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>PER</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#A000A0;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>LINUX</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(0x0000)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>#define </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>PER</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#A000A0;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>LINUX</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:#A000A0;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#A000A0;mso-font-kerning:0pt'>32BIT</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'> </span>(0x0000 | ADDR</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>LIMIT</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>32BIT)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>#define </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>PER</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#A000A0;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>SVR4</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(0x0001
  | STICKY</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>TIMEOUTS)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>#define </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>PER</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#A000A0;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>SVR3</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(0x0002
  | STICKY</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>TIMEOUTS)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>#define </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>PER</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#A000A0;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>SCOSVR3</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp; </span>(0x0003 | STICKY</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>TIMEOUTS | WHOLE</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:
  0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>SECONDS)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>#define </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>PER</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#A000A0;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>WYSEV386</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>(0x0004 | STICKY</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>TIMEOUTS)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>#define </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>PER</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#A000A0;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>ISCR4</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(0x0005 |
  STICKY</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>TIMEOUTS)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>#define </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>PER</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#A000A0;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>BSD</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(0x0006)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>#define </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>PER</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#A000A0;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>SUNOS</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#A000A0;mso-font-kerning:0pt'>PER</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:#A000A0;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>BSD</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> | STICKY</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>TIMEOUTS)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>#define </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>PER</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#A000A0;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>XENIX</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(0x0007 |
  STICKY</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>TIMEOUTS)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>#define </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>PER</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#A000A0;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>LINUX32</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp; </span>(0x0008)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>#define </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>PER</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#A000A0;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>IRIX32</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>&nbsp; </span> <span style='mso-tab-count:1'>&nbsp;&nbsp; </span>(0x0009
  | STICKY</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>TIMEOUTS) </span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;
  mso-font-kerning:0pt'>/* IRIX5 32-bit<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>*/</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>#define </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>PER</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#A000A0;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>IRIXN32</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span style='mso-tab-count:1'>&nbsp; </span>(0x<st1:chmetcnv
  TCSC="0" NumberType="1" Negative="False" HasSpace="False" SourceValue="0"
  UnitName="a" w:st="on">000a</st1:chmetcnv> | STICKY</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>TIMEOUTS) </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#009900;mso-font-kerning:0pt'>/* IRIX6 new
  32-bit */</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>#define </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>PER</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#A000A0;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>IRIX64</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>&nbsp; </span> <span style='mso-tab-count:1'>&nbsp;&nbsp; </span>(0x000b
  | STICKY</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>TIMEOUTS) </span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;
  mso-font-kerning:0pt'>/* IRIX6 64-bit<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>*/</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>#define </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>PER</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#A000A0;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>RISCOS</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>&nbsp; </span> <span style='mso-tab-count:1'>&nbsp;&nbsp; </span>(0x<st1:chmetcnv
  TCSC="0" NumberType="1" Negative="False" HasSpace="False" SourceValue="0"
  UnitName="C" w:st="on">000c</st1:chmetcnv>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>#define </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>PER</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#A000A0;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>SOLARIS</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp; </span>(0x000d | STICKY</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>TIMEOUTS)<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<h3 style='mso-list:l24 level3 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>2.4.4
</span></span><![endif]><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>执行域的注册</span></h3>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>执行域的定义和实现通常都在模块中，当插入该模块时，模块的</span>module_init<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>初始化函数会调用</span>register_exec_domain<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>函数把自己的</span>exec_domain<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>处理结构挂到内核</span>exec_domains<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>全局链表中，这就表示内核从现在起开始支持处理该操作系统编译的可执行文件。</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:91.55pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#CCFFCC;padding:0cm 5.4pt 0cm 5.4pt;
  height:91.55pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>15 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>struct</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> exec</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>domain </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>default</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:blue;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:0pt'>exec</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:blue;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>domain</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> = {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>16<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#000077;mso-font-kerning:0pt'>&quot;Linux&quot;</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>,<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#009900;mso-font-kerning:0pt'>/* name */</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;
  mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>17<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>no</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:gray;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:0pt'>lcall7</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>,<span style='mso-spacerun:yes'>&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#009900;mso-font-kerning:0pt'>/* lcall7
  causes a seg fault. */</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>18<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>0,
  0xff,<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#009900;mso-font-kerning:0pt'>/* All personalities. */</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>19<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>ident</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>map,<span style='mso-spacerun:yes'>&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#009900;mso-font-kerning:0pt'>/* Identity map signals. */</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>20<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>ident</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>map,<span style='mso-spacerun:yes'>&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#009900;mso-font-kerning:0pt'>/*<span style='mso-spacerun:yes'>&nbsp;
  </span>- both ways. */</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>21<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#A000A0;mso-font-kerning:0pt'>NULL</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>,<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#009900;mso-font-kerning:0pt'>/* No usage
  counter. */</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>22<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#A000A0;mso-font-kerning:0pt'>NULL</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#009900;mso-font-kerning:0pt'>/* Nothing after this in the list. */</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>23 };<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>24 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>25 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>static</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>struct</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> exec</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>domain *</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>exec</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:blue;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>domains</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> = &amp;default</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>exec</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>domain;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>26 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>static</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> rwlock</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>t </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>exec</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:gray;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:0pt'>domains</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>lock</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> = RW</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>LOCK</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>UNLOCKED;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>...... <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>66 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>int</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>register</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:#880000;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>exec</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:#880000;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>domain</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>(</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>struct</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> exec</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>domain *</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>it</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>67 {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>68<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>struct</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> exec</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>domain *</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>tmp</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>69 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>70<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (!</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>it</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>71<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>return</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> -</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>EINVAL</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>72<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>it</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;next)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>73<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;</span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>return</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> -</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>EBUSY</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>74<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>write</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:#880000;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>lock</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>(&amp;exec</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>domains</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>lock);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>75<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>for</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>tmp</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>=exec</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>domains; </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>tmp</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>; </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>tmp</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>=</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>tmp</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>-&gt;next)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>76<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>if</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>tmp</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> == </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>it</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>) {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>77<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>write</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>unlock(&amp;exec</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>domains</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>lock);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>78<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>return</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> -</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>EBUSY</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>79<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>}<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>80<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>it</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;next = exec</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:
  0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>domains;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>81<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>exec</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>domains = </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>it</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>82<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>write</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>unlock(&amp;exec</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:
  0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>domains</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>lock);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>83<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>return</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> 0;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>84 }<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>85<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent style='mso-char-indent-count:0'><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent style='mso-char-indent-count:0'>Linux<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>在启动时，会将首先将默认执行域</span>default_exec_domain<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>注册到</span>exec_domains<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>链表中，随后如果调用</span>register_exec_domain<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>加载了其他注册</span>exec_domain<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的模块，则会将该</span>exec_domain<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>加载在</span>exec_domains<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>最前面。从该注册函数中也可以看出，</span>default_exec_domain<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>永远位于</span>exec_domains<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>链表的末端。</span></p>

<h3 style='mso-list:l24 level3 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>2.4.5
</span></span><![endif]><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>进程寻找相应执行域的过程</span></h3>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>前面讲过，进程加载程序在分析可执行文件格式时，会依据该文件内容设置该进程的</span>task_struct-&gt;personality<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>值，然后依据该值和</span>exec_domains<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>链表中的每一个</span>exec_domain<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>成员的</span>pers_low<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>、</span>pers_high<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>比较，如果该值在</span>pers_low<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>、</span>pers_high<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>组成的区间内，则就认为该</span>exec_domain<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>就是我们要找的执行域。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>我们举例说明该过程：</span>Linux<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在调用</span>ELF<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的</span>linux_binfmt-&gt;load_binary<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（也就是</span>elf_format:load_binary<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）分析</span>ELF<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>格式的可执行文件时，首先会判断该</span>ELF<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>是在哪个操作系统上编译的，其判断方法为：如果发现该</span>ELF<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>文件的</span>interpreter<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>库为</span>&quot;/usr/lib/libc.so.1&quot;<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>或</span>&quot;/usr/lib/ld.so.1&quot;<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，则认为该</span>ELF<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>文件是在</span>SVR4<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>操作系统上编译的，其将会调用函数</span>set_personality(PER_SVR4)<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，否则就认为该</span>ELF<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件是在</span>Linux<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>上编译的，则将会调用函数</span>set_personality(PER_LINUX)<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，注意这里的</span>PER_SVR4<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和</span>PER_LINUX<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>两个值就是系统预定义</span>personality<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。就拿</span>set_personality(PER_SVR4)<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>来说吧，如下所示：</span><span lang=ZH-CN> </span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:302.45pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#CCFFCC;padding:0cm 5.4pt 0cm 5.4pt;
  height:302.45pt'>
  <p class=MsoNormal style='text-indent:4.5pt;line-height:9.0pt;mso-line-height-rule:
  exactly;mso-layout-grid-align:none;text-autospace:none'><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>46 </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>static</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>struct</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> exec</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>domain *</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>lookup</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:#880000;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>exec</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:#880000;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>domain</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>(</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>unsigned</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>long</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>personality</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;</span>47 {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;</span>48<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>unsigned</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>long</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>pers</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> = </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>personality</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;
  mso-font-kerning:0pt'> &amp; PER</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>MASK;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;</span>49<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>struct</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> exec</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>domain *</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>it</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;</span>50 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;</span>51<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>read</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:#880000;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>lock</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>(&amp;</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>exec</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:gray;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>domains</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:gray;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:0pt'>lock</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;</span>52<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>for</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>it</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>=</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>exec</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:blue;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>domains</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>; </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>it</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>; </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>it</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>=</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>it</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;next)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;</span>53<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>if</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>pers</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> &gt;= </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>it</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;pers</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>low &amp;&amp; </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>pers</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> &lt;= </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>it</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;pers</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>high) {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;</span>54<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>if</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (!try</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>inc</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>mod</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>count(</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>it</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>-&gt;module))<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;</span>55<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>continue</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;</span>56<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>read</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>unlock(&amp;</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;
  mso-font-kerning:0pt'>exec</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Lucida Sans",sans-serif;color:gray;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>domains</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:gray;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:0pt'>lock</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;</span>57<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>return</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>it</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;</span>58<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>}<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;</span>59<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>read</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>unlock(&amp;</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>exec</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>domains</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:gray;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>lock</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;</span>60 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;</span>61<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#009900;mso-font-kerning:0pt'>/* Should never get this far. */</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;</span>62<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>printk(KERN</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>ERR </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#000077;mso-font-kerning:0pt'>&quot;No
  execution domain for personality 0x%02lx\n&quot;</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>, </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>pers</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;</span>63<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>return</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>NULL</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;</span>64 }<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>......<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>105 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>void</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:#880000;
  mso-font-kerning:0pt'>__</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>set</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#880000;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>personality</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>(</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>unsigned</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>long</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>personality</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>106 {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>107<span style='mso-spacerun:yes'>&nbsp; </span><span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;</span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>struct</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> exec</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>domain *</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>it</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>, *</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>prev</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>108 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>109<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>it</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> = </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>lookup</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#880000;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>exec</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:#880000;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>domain</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>(</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>personality</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>......<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>133<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>current</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>personality</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> = </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>personality</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>134<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>prev</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> = </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>current</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;exec</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>domain;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>135<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>current</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;exec</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>domain = </span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;
  mso-font-kerning:0pt'>it</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>136<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>set</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>fs</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>altroot();<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>137<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>put</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>exec</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>domain(</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>prev</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>138 }<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>该函数首先依据</span>PER_SVR4<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在</span>exec_domains<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>链表中查找对应的</span>exec_domain<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，其查找方法是判断当前的这个</span>PER_SVR4
personality<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>值是否在该</span>exec_domain-&gt;pers_low<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>和</span>exec_domain-&gt;pers_high<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>之间，如果是，就认为该</span>exec_domain<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>要找的执行域，随后将当前进程的</span>task_struct-&gt;
personality<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>设置为</span>PER_SVR4<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，同时将当前进程的</span>task_struct-&gt;exec_domain<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>设置为刚刚找到的，也就是</span>System V Release 4<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>操作系统对应的</span>struct exec_domain<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。那要是一直找没有找到满足条件的</span>exec_domain<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>怎么办呢？前面说过</span>default_exec_domain<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>始终在</span>exec_domains<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的最末端，而且其</span>pers_low<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>和</span>pers_high<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>构成的区间为</span>[0,255]<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，而传递过来的</span>personality<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>一定不会超过</span>255<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，所以找到这里，就把</span>default_exec_domain<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>当作符合条件的执行域了。也就是说，如果没有找到实际的</span>exec_domain<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，就把</span>default_exec_domain<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>当作该进程的</span>exec_domain<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。</span></p>

<h3 style='mso-list:l24 level3 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>2.4.6
</span></span><![endif]><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>执行域的使用场合</span></h3>

<p class=MsoNormalIndent style='mso-char-indent-count:0'><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>在</span>Linux<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>执行</span>sys_sigsuspend<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>系统调用时，首先会依据当前进程的</span>exec_domain-&gt;signal_invmap<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>匹配程序代码中的信号值（编译操作系统上的信号编号）到</span>Linux<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中相应的信号编号，随后用匹配到的</span>Linux<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>信号处理函数来处理。</span></p>

<h2 style='mso-list:l24 level2 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:Arial;mso-bidi-font-family:Arial'><span
style='mso-list:Ignore'>2.5 </span></span><![endif]>do_fork<span lang=ZH-CN
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>讲解</span>(2)</h2>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>继续看</span>do_fork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的代码：</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:128.4pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#E6E6E6;padding:0cm 5.4pt 0cm 5.4pt;
  height:128.4pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'>do</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;color:red;
  mso-font-kerning:0pt'>_</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Courier New";color:red;mso-font-kerning:
  0pt'>fork :<o:p></o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>589<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>590<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>get</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>exec</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>domain(</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>p</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>-&gt;exec</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>domain);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>591 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>592<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>p</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;binfmt &amp;&amp; </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;binfmt-&gt;module)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>593<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>__</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>MOD</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>INC</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>USE</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>COUNT(</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>p</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>-&gt;binfmt-&gt;module);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>594 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:red;mso-font-kerning:
  0pt'>personality.h :<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:red;mso-font-kerning:
  0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>#define </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>get</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#A000A0;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>exec</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:#A000A0;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#A000A0;mso-font-kerning:0pt'>domain</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>(it) \<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (it &amp;&amp; it-&gt;module) </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>__</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>MOD</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>INC</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>USE</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>COUNT(it-&gt;module);<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>由于创建子进程会增加对对应执行域处理模块的引用，因此这里递增该执行域处理模块的引用计数，对于内核线程或者</span>Linux<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>自身进程而言，其执行域均为</span>default_exec_domain<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，而其</span>modules<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>为</span>NULL<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，故不存在递增模块引用计数的问题。模块在卸载的时候要依据模块的引用计数来决定是卸载该自己。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>创建子进程时，子进程会继承父进程的</span>task_struct-&gt;binfmt<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，对于从可执行文件中加载的父进程，其</span>task_struct-&gt;binfmt<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>必然为某种格式的可执行文件处理结构，该结构的实现一般均在模块中，而创建子进程会增加对该模块的引用，因此这里递增该模块的引用计数。对于内核线程而言，其</span>task_struct-&gt;binfmt==NULL<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，故不存在相应的可执行文件处理模块，也就不存在递增模块引用计数这一说了。</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:45.2pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#E6E6E6;padding:0cm 5.4pt 0cm 5.4pt;
  height:45.2pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'>do</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;color:red;
  mso-font-kerning:0pt'>_</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Courier New";color:red;mso-font-kerning:
  0pt'>fork :<o:p></o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>595<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;did</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>exec = 0;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>596<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;swappable = 0;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent>p-&gt;did_exec<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>成员用来指明该进程是否执行过</span>sys_execve<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>系统调用。当一个进程创建了一个子进程时，此时子进程的</span>task_struct-&gt;did_execv<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>为</span>0<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，表示还没有执行过</span>sys_execve<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>系统调用。当子进程返回用户空间运行时，如果其调用了</span>sys_execve<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，</span>sys_execve<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>会继续沿用原有的</span>task_struct<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>构造一个全新的进程，但是并没有创建新的</span>task_struct<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，而是继续使用原有的</span>task_strcut<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，并且继续使用此子进程的</span>pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，不会创建新的</span>pid<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，同时释放此子进程原有的资源，并依据可执行文件构建新的资源，让</span>task_struct<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中相关成员指向这些资源。</span>sys_execve<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>会将</span>p-&gt;did_exec=1<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，表示该</span>task_struct<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>从作为子进程创建起，已经调用了</span>sys_execve<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>了。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>那么该标志有什么用呢？应用层某个进程可以调用</span>setpgid(pid,
pgid)<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>设置</span>pid<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>对应的子进程的进程组</span>ID<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>为</span>pgid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，但是前提是，该子进程必须是</span>fork/clone<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>出来的子进程且没有执行过</span>execv<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，此时该函数将会设置成功，如果子进程已经执行过</span>execv<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，则函数返回失败，表示不允许设置此类子进程的进程组</span>ID<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，我们来看看</span>sys_setpgid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的实现：</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:354.2pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#CCFFCC;padding:0cm 5.4pt 0cm 5.4pt;
  height:354.2pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>764 asmlinkage </span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>long</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>sys</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:#880000;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>setpgid</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;
  mso-font-kerning:0pt'>(pid</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:
  0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>t </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>pid</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>, pid</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>t </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>pgid</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>765 {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>766<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>struct</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> task</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>struct * </span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;
  mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>......<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>782<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> = find</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>task</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>by</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>pid(</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>pid</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>783<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (!</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>p</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>784<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>goto</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>out</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>785 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>786<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>p</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>pptr == </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>current</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> || </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>p</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>opptr == </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>current</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>) {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>787<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>err</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> = -</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>EPERM</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>788<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>if</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>p</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>-&gt;session != </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>current</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;session)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>789<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;</span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>goto</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>out</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>790<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>err</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> = -</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>EACCES</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>791<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>if</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>p</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>-&gt;did</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>exec)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>792<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>goto</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>out</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>793<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>} </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>else</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>if</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>p</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> != </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>current</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>794<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>goto</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>out</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>795<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>err</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> = -</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>EPERM</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>796<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>p</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;leader)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>797<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>goto</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>out</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>798<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>pgid</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> != </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>pid</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>) {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>799<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>struct</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> task</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>struct * </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>tmp</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>800<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>for</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>each</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>task (</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>tmp</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>) {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>801<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>if</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>tmp</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>-&gt;pgrp == </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>pgid</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> &amp;&amp;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>802<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>tmp</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;session == </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>current</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;session)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>803<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>goto</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>ok</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:gray;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>pgid</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>804<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>}<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>805<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>goto</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>out</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>806<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>807 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>808 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>ok</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>pgid</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>:<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>809<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;pgrp = </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>pgid</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>810<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>err</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> = 0;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>811 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>out</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>:<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>812<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#009900;mso-font-kerning:0pt'>/* All paths lead to here, thus we are
  safe. -DaveM */</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>813<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>read</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>unlock(&amp;tasklist</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:
  0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>lock);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>814<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>return</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>err</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>815 }<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent>782<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>行首先调用函数</span>find_task_by_pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>找到该</span>pid<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>对应的</span>task_struct<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，</span>786<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>行判断该进程是否是当前进程的子进程，如果是，就会通过</span>p-&gt;did_exec<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>标志来判断该子进程是否执行过</span>execv<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，如果为</span>1<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，则表示执行过，函数返回失败，如果为</span>0<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，表示没有该子进程由父进程调用</span>fork/clone<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>创建以来，还没有执行过</span>execv<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，因此继续往下并设置好该进程的进程组</span>ID<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，函数返回成功。</span></p>

<p class=MsoNormalIndent>do_fork<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的</span>596<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>行：</span>p-&gt;swappable<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>本意是表示当前进程在创建期间不可被换出，在</span>do_fork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>函数开始时，其值为</span>0<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，在此过程中，</span>kswapd<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>不能选择该进程作为换出进程，当</span>do_fork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结束时，将该值置为</span>0<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，此时，</span>kswapd<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>可以选择该进程作为换出进程。事实上，</span>kswapd<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>并没有使用该标志来决定一个进程是否可以被换出，而是采用了其他判断依据，这里暂不说明。</span></p>

<h2 style='mso-list:l24 level2 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:Arial;mso-bidi-font-family:Arial'><span
style='mso-list:Ignore'>2.6 </span></span><![endif]><span lang=ZH-CN
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>进程的状态</span></h2>

<h3 style='mso-list:l24 level3 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>2.6.1
</span></span><![endif]>task_struct-&gt;state</h3>

<p class=MsoNormalIndent>task_struct-&gt;state<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>成员用来表明该进程的当前运行状态。如下图所示：</span></p>

<p class=MsoNormalIndent style='text-indent:0cm;mso-char-indent-count:0'><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent style='margin-right:-70.65pt;mso-para-margin-right:
-6.73gd;text-indent:0cm;mso-char-indent-count:0'><!--[if gte vml 1]><v:shape
 id="_x0000_i1029" type="#_x0000_t75" style='width:480.75pt;height:317.25pt'
 o:ole="">
 <v:imagedata src="503_files/image010.emz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=641 height=423
src="503_files/image011.gif" v:shapes="_x0000_i1029"><![endif]><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Visio.Drawing.11" ShapeID="_x0000_i1029"
  DrawAspect="Content" ObjectID="_1575099345">
 </o:OLEObject>
</xml><![endif]--></p>

<p class=MsoNormalIndent style='margin-right:-70.65pt;mso-para-margin-right:
-6.73gd;text-indent:0cm;mso-char-indent-count:0'><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent style='margin-left:21.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l20 level1 lfo7;tab-stops:list 21.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>TASK_RUNNING<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：当调用</span>sys_fork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>创建完毕一个子进程后，将进程的</span>tsk-&gt;state<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>标志为</span>TASK_RUNNING<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>状态，同时将通过</span>tsk-&gt;run_list<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>将当前进程添加到</span>runqueue_head<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>运行队列中，此时进程正在等待被</span>CPU<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>执行，当因为</span>fork<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>最后调用</span>schedule<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>或者中断返回时调用</span>schedule<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>导致调度并且选中该子进程时，进程将占用</span>CPU<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>开始运行；此时</span>tsk<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>依然在</span>runqueue_head<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>队列中，状态保持</span>TASK_RUNNING<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>；</span><br>
<br>
<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>如果当前正在</span>CPU<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中运行的该进程由于时钟中断的到来被中断，而且时钟中断返回时调用</span>schedule<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>发现为该进程分配的时间片已经用尽，则调度其他进程进入</span>CPU<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>运行，同时该进程又回到等待被</span>CPU<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>执行的状态中；</span><br style='mso-special-character:
line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]></p>

<p class=MsoNormalIndent style='margin-left:21.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l20 level1 lfo7;tab-stops:list 21.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>TASK_INTERRUPTIBLE<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>：当进程正在</span>CPU<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>中运行时，进程自己调用了函数</span>interruptible_sleep_on<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，该函数会将当前进程挂入一个等待队列，然后将进程的</span>tsk-&gt;state<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>标志为</span>TASK_INTERRUPTIBLE<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>状态，同时调用</span>schedule<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>将该进程从</span>runqueue_head<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>队列中脱离并调入其他进程进入</span>CPU<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>运行。这里相当于将当前进程转入了睡眠状态，其实睡眠状态的含义就是指该进程不在</span>runqueue_head<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>队列中，从而无法被</span>schedule<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>选中进入</span>CPU<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>运行，故形象的称之为睡眠状态；</span><br>
<br>
<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>当进程处于</span>TASK_INTERRUPTIBLE<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>状态时，如果此时外部程序用前面的等待队列作为参数调用了</span>wake_up<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>或者</span>wake_up_interruptible<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>函数时，这两个函数会将队列中所有处于</span>TASK_INTERRUPTIBLE<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>状态的进程唤醒，其实这里的唤醒也就是将进程状态设置为</span>TASK_RUNNING<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，同时将进程挂入</span>runqueue_head<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>队列中。这样这些进程又可以被</span>schedule<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>调度进入</span>CPU<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>运行了；这里需要注意的是，</span>wake_up_interruptible<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数只能唤醒</span>TASK_INTERRUPTIBLE<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>状态的进程，而不能唤醒下面将要讲到的</span>TASK_UNINTERRUPTIBLE<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>状态的进程，但是</span>wake_up<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>则可以同时唤醒这两种类型的进程；</span><br>
<br>
<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>除了</span>wake_up<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和</span>wake_up_interruptible<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数可以唤醒</span>TASK_INTERRUPTIBLE<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>状态的进程外，信号也能唤醒该状态的进程，当其他正在运行的进程发送信号给该进程时</span><span
style='background:yellow;mso-highlight:yellow'>kill(pid_t pdi, int sig)-&gt;sys_kill(int
pid, int sig)-&gt; kill_something_info(sig, &amp;info, pid)-&gt;
kill_proc_info(sig, info, pid);</span> <span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>最终</span>kill_proc_info<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>会调用函数</span><span style='background:
yellow;mso-highlight:yellow'>send_sig_info(int sig, struct siginfo *info,
struct task_struct *t)</span><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，该函数会判断进程</span>t<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>也就是当前进程是否是</span>TASK_INTERRUPTIBLE<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>状态，如果是，就将进程状态设置为</span>TASK_RUNNING<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，同时将进程挂入</span>runqueue_head<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>队列中。这样该进程又可以被</span>schedule<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>调度进入</span>CPU<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>运行了；</span><br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]></p>

<p class=MsoNormalIndent style='margin-left:21.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l20 level1 lfo7;tab-stops:list 21.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>TASK_UNINTERRUPTIBLE<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>：该状态和</span>TASK_INTERRUPTIBLE<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>非常相似，只是该状态不会理会到来的信号；当进程正在</span>CPU<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中运行时，进程自己调用了函数</span>sleep_on<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，该函数会将当前进程挂入一个等待队列，然后将进程的</span>tsk-&gt;state<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>标志为</span>TASK_UNINTERRUPTIBLE<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>状态，同时调用</span>schedule<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>将该进程从</span>runqueue_head<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>队列中脱离并调入其他进程进入</span>CPU<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>运行。此种状态只能被外部程序用前面的等待队列作为参数调用了</span>wake_up<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>才能最终唤醒该进程；而</span>send_sig_info<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>对处于该种状态的进程不会做任何处理，也就是让该进程继续睡眠了；</span></p>

<p class=MsoNormalIndent style='text-indent:0cm;mso-char-indent-count:0'><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent style='margin-left:21.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l20 level1 lfo7;tab-stops:list 21.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>TASK_STOPPED<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：当进程收到</span>SIGSTOP<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>等信号时，将会转入该状态挂起，当进程收到</span>SIGCONT<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>信号时，又会转入运行状态；我们来详细解释下这个过程，当在用户空间调用</span><span
style='background:yellow;mso-highlight:yellow'>kill –s 18 3455</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，这里</span>3455<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>就是要接受</span>SIGSTOP<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>信号的进程，</span>18<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>表示</span>SIGSTOP<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>信号，通过系统调用进入</span>send_sig_info<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，该函数调用</span>deliver_signal<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>将该信号发给该进程，如果该进程为</span>TASK_INTERRUPTIBLE<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>状态，则唤醒它。无论如何，此时该进程应该在</span>runqueue_head<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>队列中，状态为</span>TASK_RUNNING<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，当调度</span>schedule<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>调度到该进程时让该进程继续运行，势必要从系统空间回到用户空间，在返回的最后时刻会调用</span>do_signal<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，该函数会处理当前进程的所有未决信号，当找到信号</span>18<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>时，便会执行如下所示的语句，处理</span>SIGSTOP<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>信号时，会将当前进程状态设置为</span>TASK_STOPPED<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，同时调用</span>schedule<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>将该进程从</span>runqueue_head<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>队列中脱离并调入其他进程进入</span>CPU<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>运行，直到收到</span>SIGCONT<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>信号（这里不再详述）：</span></p>

<p class=MsoNormalIndent style='text-indent:0cm;mso-char-indent-count:0'><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:73.9pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#CCFFCC;padding:0cm 5.4pt 0cm 5.4pt;
  height:73.9pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>case</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> SIGSTOP:<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>current</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>state</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> = TASK</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>STOPPED;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>current</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;exit</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>code = signr;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (!(</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>current</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>pptr-&gt;sig-&gt;</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>action</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>[SIGCHLD-1].sa.sa</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:
  0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>flags &amp; SA</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>NOCLDSTOP))<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>notify</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>parent(</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>current</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>, SIGCHLD);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>schedule();<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>continue</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent style='margin-left:21.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l20 level1 lfo7;tab-stops:list 21.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>TASK_ZOMBIE<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：当子进程已经执行完毕退出时，父进程还在运行，而且父进程在创建子进程后没有调用</span>wait<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>系列函数来等待子进程返回，那么此时子进程就成了僵尸进程。为什么要这样做呢？因为在没有调用</span>wait<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>系列函数之前，父进程也许会使用包含在僵尸进程</span>task_struct<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中的数据。</span></p>

<h3 style='mso-list:l24 level3 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>2.6.2
</span></span><![endif]>task_struct-&gt;flags</h3>

<p class=MsoNormalIndent>task_struct-&gt;flags<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>也反应了进程状态的信息，不过并不是运行状态，而是与管理相关的一些信息。</span><span lang=ZH-CN> </span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:155.5pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#CCFFCC;padding:0cm 5.4pt 0cm 5.4pt;
  height:155.5pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>399 /*<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>400<span style='mso-spacerun:yes'>&nbsp; </span>* Per process flags<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>401<span style='mso-spacerun:yes'>&nbsp; </span>*/<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>402 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#999999;mso-font-kerning:0pt'>#define PF</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#999999;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#999999;mso-font-kerning:
  0pt'>ALIGNWARN</span><span style='color:#999999'><span style='mso-tab-count:
  1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#999999;
  mso-font-kerning:0pt'>0x00000001</span><span style='mso-tab-count:1'>&nbsp;&nbsp; </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#009900;mso-font-kerning:0pt'>/* Print alignment warning msgs */</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>403<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='mso-tab-count:5'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#009900;mso-font-kerning:0pt'>/* Not implemented yet, only for 486*/</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>404 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#999999;mso-font-kerning:0pt'>#define PF</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#999999;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#999999;mso-font-kerning:
  0pt'>STARTING </span><span style='color:#999999'><span style='mso-tab-count:
  1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#999999;
  mso-font-kerning:0pt'>0x00000002 </span><span style='mso-tab-count:1'>&nbsp; </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#009900;mso-font-kerning:0pt'>/* being created */</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>405 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>#define </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#A000A0;mso-font-kerning:0pt'>PF</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:#A000A0;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>EXITING</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><span style='mso-spacerun:yes'>&nbsp;
  </span></span><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>0x00000004 </span><span style='mso-tab-count:
  1'>&nbsp; </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#009900;mso-font-kerning:0pt'>/* getting shut
  down */</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>406 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#999999;mso-font-kerning:0pt'>#define PF</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#999999;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#999999;mso-font-kerning:
  0pt'>FORKNOEXEC</span><span style='color:#999999'><span style='mso-tab-count:
  1'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#999999;mso-font-kerning:
  0pt'>0x00000040</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> </span><span
  style='mso-tab-count:1'>&nbsp; </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>/* forked but didn't exec */</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>407 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#999999;mso-font-kerning:0pt'>#define PF</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#999999;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#999999;mso-font-kerning:
  0pt'>SUPERPRIV<span style='mso-spacerun:yes'>&nbsp; </span></span><span
  style='color:#999999'><span style='mso-tab-count:1'>&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#999999;mso-font-kerning:0pt'>0x00000100 </span><span style='mso-tab-count:
  1'>&nbsp; </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#009900;mso-font-kerning:0pt'>/* used
  super-user privileges */</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>408 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#999999;mso-font-kerning:0pt'>#define PF</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#999999;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#999999;mso-font-kerning:
  0pt'>DUMPCORE <span style='mso-spacerun:yes'>&nbsp;&nbsp;</span></span><span
  style='color:#999999'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#999999;mso-font-kerning:0pt'>0x00000200</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;
  mso-font-kerning:0pt'> </span><span style='mso-tab-count:1'>&nbsp; </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#009900;mso-font-kerning:0pt'>/* dumped core */</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>409 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#999999;mso-font-kerning:0pt'>#define PF</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#999999;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#999999;mso-font-kerning:
  0pt'>SIGNALED <span style='mso-spacerun:yes'>&nbsp;</span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><span
  style='mso-spacerun:yes'>&nbsp;</span></span><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>0x00000400 </span><span style='mso-tab-count:
  1'>&nbsp; </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#009900;mso-font-kerning:0pt'>/* killed by a
  signal */</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>410 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>#define </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#A000A0;mso-font-kerning:0pt'>PF</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:#A000A0;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>MEMALLOC</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>0x00000800 </span><span style='mso-tab-count:
  1'>&nbsp; </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#009900;mso-font-kerning:0pt'>/* Allocating
  memory */</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>411 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>#define </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#A000A0;mso-font-kerning:0pt'>PF</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:#A000A0;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>VFORK</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>0x00001000 </span><span style='mso-tab-count:
  1'>&nbsp; </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#009900;mso-font-kerning:0pt'>/* Wake up
  parent in mm</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:#009900;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#009900;mso-font-kerning:0pt'>release */</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;
  mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>412 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>413 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#999999;mso-font-kerning:0pt'>#define PF</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#999999;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#999999;mso-font-kerning:
  0pt'>USEDFPU<span style='mso-spacerun:yes'>&nbsp; </span></span><span
  style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>0x00100000 </span><span style='mso-tab-count:
  1'>&nbsp; </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#009900;mso-font-kerning:0pt'>/* task used
  FPU this quantum (SMP) */</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>414 <o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent style='margin-left:21.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l20 level1 lfo7;tab-stops:list 21.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]><span style='background:silver;mso-highlight:
silver'>PF_ALIGNWARN</span><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";background:silver;
mso-highlight:silver'>仅用于</span><span style='background:silver;mso-highlight:
silver'>486</span><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";background:silver;
mso-highlight:silver'>；</span><span style='background:silver;mso-highlight:
silver'>PF_STARTING</span><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";background:silver;
mso-highlight:silver'>用意表示进程正在创建中，不过实际没有使用；</span><span style='background:silver;
mso-highlight:silver'>PF_SUPERPRIV</span><span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
background:silver;mso-highlight:silver'>、</span><span style='background:silver;
mso-highlight:silver'>PF_FORKNOEXEC</span><span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
background:silver;mso-highlight:silver'>、</span><span style='background:silver;
mso-highlight:silver'>PF_DUMPCORE</span><span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
background:silver;mso-highlight:silver'>、</span><span style='background:silver;
mso-highlight:silver'>PF_SIGNALED</span><span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
background:silver;mso-highlight:silver'>均用于</span><span style='background:silver;
mso-highlight:silver'>CONFIG_BSD_PROCESS_ACCT</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:silver;mso-highlight:silver'>场合；</span><span
style='background:silver;mso-highlight:silver'>PF_USEDFPU</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";background:silver;mso-highlight:silver'>用于</span><span
style='background:silver;mso-highlight:silver'>SMP</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:silver;mso-highlight:silver'>；这几者我们就不多说了；</span></p>

<p class=MsoNormalIndent style='margin-left:21.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l20 level1 lfo7;tab-stops:list 21.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>PF_EXITING<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，该标志表示当前进程已经调用</span>do_exit<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，将要被销毁了，</span>do_exit<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>会将</span>tsk-&gt;flags |= PF_EXITING<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。举例说明该标志的应用场合，建立一个</span>socket<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>连接后，可以通过</span>setsockopt<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>设置该</span>socket<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的属性，其中</span> SO_LINGER<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>选项表明</span>close<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>或</span> shutdown<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>将该</span>socket<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>时，必须等到所有套接字里排队的消息成功发送或到达延迟时间后才会返回，但是前提必须是进程还没有调用</span>do_exit<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。如果没有设置该选项，调用将立即返回。我们来看看</span>socket-&gt;close<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>最终调用的系统函数</span>inet_release<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>：</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:232.45pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#CCFFCC;padding:0cm 5.4pt 0cm 5.4pt;
  height:232.45pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>424 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>int</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>inet</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:#880000;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>release</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;
  mso-font-kerning:0pt'>(</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:0pt'>struct</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>socket</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> *</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>sock</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>425 {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>426<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>struct</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>sock</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> *</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>sk</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> = </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>sock</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>sk</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>427 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>428<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>sk</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>) {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>429<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>long</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>timeout</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>430 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>431<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#009900;mso-font-kerning:0pt'>/* Applications
  forget to leave groups before exiting */</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>432<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>ip</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>mc</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>drop</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>socket(</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>sk</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>433 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>434<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#009900;mso-font-kerning:0pt'>/* If linger is
  set, we don't return until the close<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>435<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>* is complete.<span style='mso-spacerun:yes'>&nbsp; </span>Otherwise
  we return immediately. The<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>436<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>* actually closing is done the same either way.<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>437<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>*<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>438<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>* If the close is due to the process exiting, we never<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>439<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>* linger..<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#009900;mso-font-kerning:
  0pt'>440<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>*/</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>441<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>timeout</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> = 0;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>442<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span><span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>sk</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>linger</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> &amp;&amp; !(</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>current</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>flags</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> &amp; PF</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>EXITING))<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>443<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>timeout</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> = </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>sk</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>-&gt;lingertime;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>444<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>sock</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>sk</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> = </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#A000A0;mso-font-kerning:0pt'>NULL</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>445<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>sk</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;prot-&gt;</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>close</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>(</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>sk</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>, </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>timeout</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>446<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>447<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>return</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>(0);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>448 }<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:0cm;mso-char-indent-count:0'><span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>可见，如果设置了</span>SO_LINGER<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>选项，那么将会设置到达制定的延迟时间后才会返回，不过前提是通过</span>PF_EXITING<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>判断当前进程是否已经调用</span>do_exit<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>准备退出了，如果是，就不需要设置</span>linger<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>延时了，因为进程一旦关闭应该关闭所有的</span>socket<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，故设置</span>timeout<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>为</span>0<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，从而立刻关闭该</span>socket<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>；</span></p>

<p class=MsoNormalIndent style='margin-left:21.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l20 level1 lfo7;tab-stops:list 21.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>PF_MEMALLOC <br>
<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";background:red;mso-highlight:red'>该标志的作用：</span><br>
<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";background:yellow;mso-highlight:yellow'>当进程包含该标志时，在</span><b
style='mso-bidi-font-weight:normal'><span style='color:red;background:yellow;
mso-highlight:yellow'>alloc_pages</span></b><span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
background:yellow;mso-highlight:yellow'>有着空闲内存分配优先权：当所有区域空闲页面都低于相应区域的</span><span
style='background:yellow;mso-highlight:yellow'>pages_min/4</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";background:yellow;mso-highlight:yellow'>水位时，</span><span
style='background:yellow;mso-highlight:yellow'>alloc_pages</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";background:yellow;mso-highlight:yellow'>不允许没有被设置标志</span><span
style='background:yellow;mso-highlight:yellow'>PF_MEMALLOC</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";background:yellow;mso-highlight:yellow'>的进程这些区域仅剩的空闲页面，而只允许这些进程使用这些区域的不活跃干净队列中的页面，如果该队列中的页面不足，则只有等待</span><span
style='background:yellow;mso-highlight:yellow'>kswapd</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:yellow;mso-highlight:yellow'>换出更多的不活跃干净页面；</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";background:aqua;mso-highlight:aqua'>同时有该标志的包括内存管理进程</span><span
style='background:aqua;mso-highlight:aqua'>kswapd</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:aqua;mso-highlight:aqua'>，其</span><span
style='background:aqua;mso-highlight:aqua'>flags |= PF_MEMALLOC</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";background:aqua;mso-highlight:aqua'>，利用该标志，</span><b
style='mso-bidi-font-weight:normal'><span style='color:red;background:aqua;
mso-highlight:aqua'>alloc_pages</span></b><span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
background:aqua;mso-highlight:aqua'>禁止该进程其从不活跃队列中分配</span><span
style='background:aqua;mso-highlight:aqua'>page</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:aqua;mso-highlight:aqua'>，因为操作不活跃队列的主要进程就是</span><span
style='background:aqua;mso-highlight:aqua'>kswapd</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:aqua;mso-highlight:aqua'>，在操作该队列时，需要为该队列加锁。而另一方面，由于</span><span
style='background:aqua;mso-highlight:aqua'>kswapd</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:aqua;mso-highlight:aqua'>本身也可能要用到</span><span
style='background:aqua;mso-highlight:aqua'>alloc_pages</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:aqua;mso-highlight:aqua'>，如果此时</span><span
style='background:aqua;mso-highlight:aqua'>alloc_pages</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:aqua;mso-highlight:aqua'>准备从不活跃队列中找一个可分配的页面，那么就不得不等待</span><span
style='background:aqua;mso-highlight:aqua'>kswapd</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:aqua;mso-highlight:aqua'>释放该队列锁，这样很容易因为读写锁造成的死锁，故禁止</span><span
style='background:aqua;mso-highlight:aqua'>kswapd</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";background:aqua;mso-highlight:aqua'>从不活跃干净队列里面直接分配内存。</span><br>
<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";background:red;mso-highlight:red'>在如下场合该标志被设置：</span><br>
1<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>、</span>kswapd<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和</span>kreclaimd<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>将自己的</span>tsk-&gt;flags
|= PF_MEMALLOC<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，因为该进程是内存管理进程，在分配内存时具有优先权；</span><br>
2<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>、</span>kswapd<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>如果发现空闲页面和不活跃页面总数小于</span>freepages.low<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，并且也没有足够的交换空间，也就是说没有足够的内存可用更没有可换出的内存了，则调用</span>oom_kill<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>函数挑选一个进程并</span>kill<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>掉它，从而释放出较多的内存，此时被</span>oom_kill<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的进程将会被打上</span>PF_MEMALLOC<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>标志，并且给该进程发送</span>SIGTERM<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>或</span>SIGKILL<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>信号，杀掉该进程。这里给该进程打上该标志，表示该进程被内存管理进程选中了将要杀掉了，因此该进程在退出期间如果需要调用</span>alloc_pages<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>来分配页面助其完成退出任务，则此时给该进程高优先级分配内存</span>----PF_MEMALLOC<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>标志，让其尽快分配成功从而尽快退出。一旦退出就释放出更多的空闲页面了。</span><br>
3<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>、</span>alloc_pages<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>在判断内存高度缺乏的时候会调用</span>page_launder<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>来将不活跃脏队列中的一些页面内容写入到磁盘中，随后将这些页面移动到不活跃干净队列中，然后再从现在的不活跃干净队列中试图分配页面，因为现在不活跃干净页面数量可能增加了。在</span>page_launder<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>将不活跃脏队列中的一些页面内容写入到磁盘并将这些页面移动到不活跃干净队列中时，</span>page_launder<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>可能会再次调用</span>alloc_pages<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>分配内存来完成该项任务，这里就有问题了，当前的该</span>alloc_pages<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>已经分配不了页面了，再次调用</span>alloc_pages<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>不是更加分配不了了么？为了解决这个问题，在</span>page_launder<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>调用之前，给当前进程打上</span>PF_MEMALLOC<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>标志，这样再次调用的这个</span>alloc_pages<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>就会有更高的权利去分配页面，当</span>page_launder<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>成功返回时，则应该关闭当前进程的</span>PF_MEMALLOC<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>标志了，由于刚刚的</span>page_launder<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>可能已经增加了不活跃干净队列中的页面，当前的</span>alloc_pages<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>再从现在的不活跃干净队列中试图分配页面，没准能够成功，如果成功，</span>alloc_pages<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>就返回了；</span><br>
4<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>、</span>alloc_pages<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>在几乎已经无能为力了的情况下，对于设置了</span>GFP_WAIT<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的分配请求，会调用</span>try_to_free_pages<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>来释放一些</span>cache/slab<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>等页面，该过程也是会碰到和前面类似的问题</span>----<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>即二次调用</span>alloc_pages<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，道理和</span>3<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中类似；</span></p>

<p class=MsoNormalIndent style='margin-left:21.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l20 level1 lfo7;tab-stops:list 21.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]>PF_VFORK<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：关于</span>vfork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的使用中我们提到过</span>vfork<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>子进程在退出时会唤醒父进程，其实</span>vfork<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>就是</span>do_exit-&gt;__exit_mm-&gt;mm_relese<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中唤醒父进程的，</span>mm_release<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>决定是否唤醒父进程的依据就是判断当前</span>tsk-&gt;flags<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中是否包含了</span>PF_VFORK<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>标志，在</span>sys_vfork<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>系统调用中会把自己的</span>tsk-&gt;flags|=PF_VFORK<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。另外就是一个</span>vfork<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>出来的子进程也许会调用</span>fork<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>或者</span>clone<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，此时</span>fork<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>或者</span>clone<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>出来的子子进程不应该还打着</span>PF_VFORK<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>标志，因此在</span>do_fork<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中会将子进程</span>tsk-&gt;flags<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>中的</span>PF_VFORK<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>标志去掉；从下面的代码中可以很容易的看出这个道理：</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:256.55pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#CCFFCC;padding:0cm 5.4pt 0cm 5.4pt;
  height:256.55pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'>do</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;color:red;
  mso-font-kerning:0pt'>_</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Courier New";color:red;mso-font-kerning:
  0pt'>exit-&gt;</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;color:red;
  mso-font-kerning:0pt'>__</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Courier New";color:red;mso-font-kerning:
  0pt'>exit</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;color:red;
  mso-font-kerning:0pt'>_</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Courier New";color:red;mso-font-kerning:
  0pt'>mm-&gt;mm</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;color:red;
  mso-font-kerning:0pt'>_</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Courier New";color:red;mso-font-kerning:
  0pt'>relese:<o:p></o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>void</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>mm</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:#880000;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>release</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>(</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>void</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>{<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>struct</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> task</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>struct *</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>tsk</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> = </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>current</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#009900;mso-font-kerning:0pt'>/* notify parent sleeping on vfork() */</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>tsk</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>flags</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> &amp; PF</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>VFORK) {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>tsk</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>flags</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> &amp;= ~PF</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>VFORK;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>up(</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>tsk</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;p</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>opptr-&gt;vfork</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>sem);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>}<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'>do</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;color:red;
  mso-font-kerning:0pt'>_</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Courier New";color:red;mso-font-kerning:
  0pt'>fork--&gt;copy</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;color:red;
  mso-font-kerning:0pt'>_</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Courier New";color:red;mso-font-kerning:
  0pt'>flags:<o:p></o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>static</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>inline</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>void</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>copy</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:#880000;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>flags</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>(</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>unsigned</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>long</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>clone</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:gray;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:0pt'>flags</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>, </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>struct</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> task</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>struct *</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>p</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>{<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>unsigned</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>long</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>new</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:gray;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>flags</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> = </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>p</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>flags</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>new</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:gray;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:0pt'>flags</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> &amp;= ~(PF</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>SUPERPRIV | PF</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:
  0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>USEDFPU | PF</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>VFORK);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>new</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:gray;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:0pt'>flags</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> |= PF</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>FORKNOEXEC;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (!(</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>clone</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>flags</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> &amp; CLONE</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>PTRACE))<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;ptrace = 0;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>clone</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>flags</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> &amp; CLONE</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>VFORK)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>new</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:gray;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:0pt'>flags</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> |= PF</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>VFORK;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>flags</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> = </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>new</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:gray;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>flags</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>}<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent style='text-indent:0cm;mso-char-indent-count:0'><o:p>&nbsp;</o:p></p>

<h2 style='mso-list:l24 level2 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:Arial;mso-bidi-font-family:Arial'><span
style='mso-list:Ignore'>2.7 </span></span><![endif]>do_fork<span lang=ZH-CN
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>讲解</span>(3)</h2>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>继续阅读</span>do_fork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的代码：</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:59.4pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#E6E6E6;padding:0cm 5.4pt 0cm 5.4pt;
  height:59.4pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'>do</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;color:red;
  mso-font-kerning:0pt'>_</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Courier New";color:red;mso-font-kerning:
  0pt'>fork :<o:p></o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>597<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>state</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> = TASK</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>UNINTERRUPTIBLE;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>598 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>599<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>copy</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>flags(clone</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>flags, </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>p</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>);<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>在子进程的创建过程中，子进程是不应该受到调度和收到信号的，在</span>do_fork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的后期，会调用</span>SET_LINKS(p)<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>、</span>hash_pid(p)<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>等将子进程加入到父进程的相关队列以及系统用于管理进程的队列中去，为了防止外界调度以及信号的影响，在</span>do_fork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>初期，也就是</span>597<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>行，将子进程的</span>state<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>标志为</span>TASK_UNINTERRUPTIBLE<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>以免受影响。在创建完毕之后，</span>do_fork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>会调用</span>wake_up_process(p)<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>将该子进程加入</span>runqueue_head<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>队列，状态设为</span>TASK_RUNNING<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>下面我们来看看</span>copy_flags<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>做了些什么：</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:112.8pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#CCFFCC;padding:0cm 5.4pt 0cm 5.4pt;
  height:112.8pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>static</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>inline</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>void</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>copy</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:#880000;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>flags</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>(</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>unsigned</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>long</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>clone</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:gray;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:0pt'>flags</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>, </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>struct</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> task</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>struct *</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>p</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>{<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>unsigned</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>long</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>new</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:gray;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>flags</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> = </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>p</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>flags</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>new</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:gray;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:0pt'>flags</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> &amp;= ~(PF</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>SUPERPRIV | PF</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:
  0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>USEDFPU | PF</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>VFORK);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>new</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:gray;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:0pt'>flags</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> |= PF</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>FORKNOEXEC;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (!(</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>clone</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>flags</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> &amp; CLONE</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>PTRACE))<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;ptrace = 0;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>clone</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:gray;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>flags</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> &amp; CLONE</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>VFORK)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>new</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:gray;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:0pt'>flags</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> |= PF</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>VFORK;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>flags</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> = </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>new</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:gray;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>flags</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>}<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>我们主要关注</span>PF_VFORK<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>和</span>CLONE_PTRACE<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，其他无需关注，因为几乎没用上。其实</span>task_struct-&gt;flags<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>一节已经说明了这个道理，为了让</span>mm_release<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>具备是否唤醒父进程的依据，</span>vfork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>出的子进程将自己</span>tsk-&gt;flags|=PF_VFORK<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>给</span>mm_release<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>来自行判断是否是否唤醒父进程。另外，</span>vfork<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>出来的子进程也许会调用</span>fork<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>或者</span>clone<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，此时</span>fork<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>或者</span>clone<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>出的子子进程不应该还打着</span>PF_VFORK<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>标志，因此在</span>do_fork<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中会将子进程</span>tsk-&gt;flags<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>中的</span>PF_VFORK<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>标志首先去掉，后面发现是</span>vfork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>时，再将该标志打上，但是如果发现不是</span>vfork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，则就无需再打上该标志了。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>关于</span>CLONE_PTRACE<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，我们知道</span>gdb<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>可以调试一个运行的进程，就会用到这个标志，当父进程正在被</span>gdb<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>调试时，器可以通过</span>clone<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>调用中的</span>clone_flags<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>决定让子进程是否也参与被</span>gdb<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>调试，如果</span>clone_flags<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中包含了</span>CLONE_PTRACE<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，则子进程的也会参与被</span>gdb<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>调试，此时子进程的</span>tsk-&gt;ptrace<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>完全复制了父进程的</span>tsk-&gt;ptrace<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，如果</span>clone_flags<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>中没有包含</span>CLONE_PTRACE<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，则子进程不应该参与调试，故将子进程的</span>tsk-&gt;ptrace=0<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。</span></p>

<h3 style='mso-list:l24 level3 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>2.7.1
</span></span><![endif]>get_pid</h3>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:37.55pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#E6E6E6;padding:0cm 5.4pt 0cm 5.4pt;
  height:37.55pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'>do</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;color:red;
  mso-font-kerning:0pt'>_</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Courier New";color:red;mso-font-kerning:
  0pt'>fork :<o:p></o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>600<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;pid = get</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:
  0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>pid(clone</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>flags);<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent>get_pid<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>用来为该子进程赋个</span>pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>用于索引和搜索，我们来看看</span>get_pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的实现原理：</span></p>

<p class=MsoNormalIndent style='text-indent:0cm;mso-char-indent-count:0'><!--[if gte vml 1]><v:shape
 id="_x0000_i1030" type="#_x0000_t75" style='width:414.75pt;height:214.5pt'
 o:ole="">
 <v:imagedata src="503_files/image012.emz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=553 height=286
src="503_files/image013.gif" v:shapes="_x0000_i1030"><![endif]><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Visio.Drawing.11" ShapeID="_x0000_i1030"
  DrawAspect="Content" ObjectID="_1575099346">
 </o:OLEObject>
</xml><![endif]--></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l16 level1 lfo8;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>n<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]><b style='mso-bidi-font-weight:normal'><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第一阶段：</span></b><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>首先申明内核将最后产生的</span>pid<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>保存在</span>last_pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>全局变量中。当系统捏造出第一个进程时，其</span>pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>为</span>0<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，</span>last_pid<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>也为</span>0<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。随着不断的</span>fork/clone/kernel_thread<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，系统</span>last_pid = last_pid+1<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，并将</span>last_pid<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>作为新的</span>pid<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>中。如图中</span>A<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>所示，当然在递增的过程中，前面有些进程可能已经销毁了，这样这些进程占用的</span>pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>就释放了，但是新的进程依然</span>pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>依然继续使用</span>last_pid+1<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>往上递增，并不会使用刚刚已经销毁的进程的</span>pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l16 level1 lfo8;tab-stops:list 42.0pt'><![if !supportLists]><span
style='font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-font-family:
Wingdings'><span style='mso-list:Ignore'>n<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span></span><![endif]><b style='mso-bidi-font-weight:normal'><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第二阶段：</span></b><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>当</span>last_pid==8000H-1(32767)<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>时，也就是</span>last_pid+1=8000H<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>时，如图</span>B<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>所示，新的</span>pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>将不会采用</span>last_pid+1<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>了，而是从</span>300<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>开始，如图</span>C<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>所示，如果</span>300<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>位置没有进程，则使用</span>300<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>作为新的</span>pid<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，并保存在</span>last_pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中，如果</span>300<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>已经有人占用，如图</span>D<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>所示，则顺序往后找，直到找到第一个没有人占用的</span>pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，作为新的</span>pid<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，并保存在</span>last_pid<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>中。随后如果再次需要新的</span>pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，而又发现</span>last_pid<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>本身位置处已经没有进程占用，也就是前一个创建的进程已经销毁，则就是用该</span>last_pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>作为新的</span>pid<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，否则就顺序往后找，直到找到第一个没有被使用的</span>pid<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>作为新的</span>pid<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，并保存在</span>last_pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中。</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>两个注意事项：</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l8 level1 lfo9;tab-stops:list 42.0pt'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>在</span>fork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>进程的时候，可以让父进程和子进程使用同一个</span>PID<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，只要在调用</span>do_fork<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>时候给</span>clone_flags<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>参数传递</span>CLONE_PID<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>标识就可以了，但是</span>Linux<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>内核只允许父进程为</span>0<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>号进程时才可以这样做。这里就是针对这种情况进行检查，如果发现</span>clone_flags<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>包含</span>CLONE_PID<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>标志，但是当前进程不是</span>0<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>号进程，则返回失败，如果是继续往下处理。在下面调用</span>get_pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>为子进程分配</span>pid<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>时，如果发</span>CLONE_PID<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>标志，则直接返回父进程的</span>pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>作为子进程的</span>pid<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。这也是重复前面的叙述；</span></p>

<p class=MsoNormalIndent style='margin-left:42.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l8 level1 lfo9;tab-stops:list 42.0pt'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>第二，第二阶段中从</span>300<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>开始的原因就是不去搜索为大部分守护进程所使用的</span>pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>范围。因为大部分守护进程都是内核启动是加载的内核守护线程和系统启动时的应用层守护进程，这样他们大部分都占据了最开始的</span>pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，而且他们一经启动后，基本就不会退出了，因此在分配新的进程</span>pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>时，出于效率和刚刚描述的原因，就不去开始部分的</span>pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>范围搜索了，</span>Linux<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>系统选择</span>300<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>作为分界线也是大概选的，并没有明确的要求，其实</span>200<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>也没什么不可以；另外，虽然说</span>300<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>以内大部分是守护进程，但是在第一阶段中，应用程序依然可以使用这段范围的</span>pid<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的，只是第二阶段就不可以了。</span></p>

<h3 style='mso-list:l24 level3 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>2.7.2
</span></span><![endif]>run_list</h3>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:65.4pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#E6E6E6;padding:0cm 5.4pt 0cm 5.4pt;
  height:65.4pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'>do</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;color:red;
  mso-font-kerning:0pt'>_</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Courier New";color:red;mso-font-kerning:
  0pt'>fork :<o:p></o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>601 <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>602<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;run</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>list.next = </span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;
  mso-font-kerning:0pt'>NULL</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>603<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;run</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>list.prev = </span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;
  mso-font-kerning:0pt'>NULL</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>604 <o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>调度程序只从</span>runqueue_head<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>队列中选择进程进入</span>CPU<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>执行，</span>task_struct<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>通过</span>run_list<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>链入该队列，进程在创建完毕后时，会将自己链入该队列，进程执行了睡眠函数时就会从该队列中脱链，被唤醒时又链入该队列。调度程序会改变进程在队列中的位置，从而改变了被调度上的几率。该队列的变化是极其频繁的。此时将进程的</span>run_list<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>指针设置为</span>NULL<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，表示暂时不入</span>runqueue_head<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>队列。</span></p>

<h3 style='mso-list:l24 level3 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>2.7.3
</span></span><![endif]><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>父子进程之间的关系</span></h3>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>进程创建子进程会产生他们之间的父子关系，而当一个父进程创建了多个子进程时，这些子进程就形成了兄弟关系。进程</span>0<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>【也就是那个捏造出来的</span>init_task<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>】和进程</span>1<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>【通过</span>kernel_thread<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>创建的最终会调用</span>execvexecve(&quot;/sbin/init&quot;)
<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>】是内核创建的，其中进程</span>1<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>是所有进程的祖先。</span>task_struct<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>结构中包含了几个成员用来表达这种关系：</span></p>

<p class=MsoNormalIndent style='margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l6 level1 lfo10;tab-stops:list 39.0pt'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman";color:gray'><span
style='mso-list:Ignore'>1、<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span></span><![endif]><span
style='color:gray'>p_opptr</span><span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:gray'>，真正的父亲。该指针指向创建该子进程的父进程</span><span style='color:gray'>tsk</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:gray'>，如果该父进程已经销毁，则指向</span><span
style='color:gray'>1</span><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:gray'>号进程</span><span
style='color:gray'>init</span><span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:gray'>，例如当</span><span style='color:gray'>shell</span><span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:gray'>启动一个守护进程如</span><span style='color:gray'>sshd</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:gray'>然后退出了登录就会产生这种情况；</span><span
style='color:gray'><o:p></o:p></span></p>

<p class=MsoNormalIndent style='margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l6 level1 lfo10;tab-stops:list 39.0pt'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman";color:green'><span
style='mso-list:Ignore'>2、<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span></span><![endif]><span
style='color:green'>p_pptr</span><span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:green'>，当前的父亲。一般情况下该指针和</span><span style='color:green'>p_opptr</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:green'>完全一样，但是当某个进程调用</span><span
style='color:green'>ptrace</span><span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:green'>调试该进程时，那么该进程的</span><span style='color:green'>p_pptr</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:green'>将会指向该调试进程的</span><span
style='color:green'>tsk</span><span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:green'>，此时就会和</span><span style='color:green'>p_opptr</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:green'>不一样了；</span><span
style='color:green'><o:p></o:p></span></p>

<p class=MsoNormalIndent style='margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l6 level1 lfo10;tab-stops:list 39.0pt'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman";color:#FF6600'><span
style='mso-list:Ignore'>3、<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span></span><![endif]><span
style='color:#FF6600'>p_cptr</span><span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:#FF6600'>，指向当前进程创建的最年轻的子进程</span><span style='color:#FF6600'>tsk</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:#FF6600'>，也就是最后创建的子进程；</span><span
style='color:#FF6600'><o:p></o:p></span></p>

<p class=MsoNormalIndent style='margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l6 level1 lfo10;tab-stops:list 39.0pt'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman";color:#993366'><span
style='mso-list:Ignore'>4、<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span></span><![endif]><span
style='color:#993366'>p_ysptr</span><span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:#993366'>，指向父进程在创建自己后创建的那个子进程的</span><span style='color:#993366'>tsk</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:#993366'>；</span><span
style='color:#993366'><o:p></o:p></span></p>

<p class=MsoNormalIndent style='margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l6 level1 lfo10;tab-stops:list 39.0pt'><![if !supportLists]><span
style='mso-fareast-font-family:"Times New Roman";color:olive'><span
style='mso-list:Ignore'>5、<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span></span><![endif]><span
style='color:olive'>p_osptr</span><span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:olive'>，指向父进程在创建自己前创建的那个子进程的</span><span style='color:olive'>tsk</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:olive'>；</span><span
style='color:olive'><o:p></o:p></span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>这些指针关系如下图所示：</span></p>

<p class=MsoNormalIndent align=center style='text-align:center'><!--[if gte vml 1]><v:shape
 id="_x0000_i1031" type="#_x0000_t75" style='width:300.75pt;height:273pt'
 o:ole="">
 <v:imagedata src="503_files/image014.emz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=401 height=364
src="503_files/image015.gif" v:shapes="_x0000_i1031"><![endif]><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Visio.Drawing.11" ShapeID="_x0000_i1031"
  DrawAspect="Content" ObjectID="_1575099347">
 </o:OLEObject>
</xml><![endif]--></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>我们继续看</span>do_fork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的代码：</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:88.35pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#E6E6E6;padding:0cm 5.4pt 0cm 5.4pt;
  height:88.35pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'>do</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;color:red;
  mso-font-kerning:0pt'>_</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Courier New";color:red;mso-font-kerning:
  0pt'>fork :<o:p></o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>605<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>if</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> ((clone</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>flags &amp; CLONE</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>VFORK) || !(clone</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:
  0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>flags &amp; CLONE</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>PARENT)) {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>606<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>p</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>opptr = </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>current</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>607<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>if</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (!(</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>p</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>-&gt;ptrace &amp;
  PT</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:
  "Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>PTRACED))<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>608<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>p</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>pptr = </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>current</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>609<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>610<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;p</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>cptr = </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>NULL</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>这里需要说明的是</span>p_opptr<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，对于</span>vfork<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>出的子进程必须要知道其原始创建父进程，因为其还要唤醒正在睡眠中的原始创建父进程呢，该父进程只能由该</span>vfork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>出的子进程唤醒，因此这里将</span>vfork<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>出的子进程</span>p_opptr<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>设置，并指向该创建父进程。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>对于指定了</span>CLONE_PARENT<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的</span>clone<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>调用，表示将要创建的子进程使用和父进程一样的原始创建父进程，相当于位置从父进程那里复制过来的</span>p_opptr<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>不变，也就是指向父进程的父进程；如果没有制定这个选项，则默认设置将要创建的子进程</span>p_opptr<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>指向当前进程，一般的</span>fork/clone(<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>没指定</span>CLONE_PARENT)/kernel_thread<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>都符合此种情况；</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>如果当前进程也就是父进程，正在被某调试程序调试，那么该父进程的</span>p_pptr<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>必然指向调试进程</span>tsk<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，但是如果父进程在</span>clone<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>子进程时没有指定</span>CLONE_PTRACE<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，参照前面的</span>copy_flags<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，子进程的</span>p-&gt;ptrace<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>必然为</span>0<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，故该子进程的父进程为当前创建进程，也就是这里的父进程。如果指定了</span>CLONE_PTRACE<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，而且父进程也在被调试中，那么子进程的父进程就会沿用复制过来的父进程的父进程，不会做任何改动，也就是和父进程一样，指向当前调试进程。当然对于指定了</span>CLONE_PARENT<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的</span>clone<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>调用，则无需判断，直接沿用复制过来的父进程</span>p_opptr(<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>指向父进程的父进程</span>)<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>以及</span>p_pptr(<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>指向调试进程</span>)<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span></p>

<p class=MsoNormalIndent>610<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>设置该子进程的</span>p_ctptr=NULL<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，因为改子进程刚创建，哪来自己的子进程呢！</span></p>

<h2 style='mso-list:l24 level2 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:Arial;mso-bidi-font-family:Arial'><span
style='mso-list:Ignore'>2.8 </span></span><![endif]>do_fork<span lang=ZH-CN
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>讲解</span>(4)</h2>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:60.2pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#E6E6E6;padding:0cm 5.4pt 0cm 5.4pt;
  height:60.2pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'>do</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;color:red;
  mso-font-kerning:0pt'>_</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Courier New";color:red;mso-font-kerning:
  0pt'>fork :<o:p></o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>611<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>init</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>waitqueue</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>head(&amp;</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;
  mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>-&gt;wait</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>chldexit);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>612<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;vfork</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>sem = </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>NULL</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>613<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>spin</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>lock</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>init(&amp;</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;
  mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>-&gt;alloc</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>lock);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>614<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>我们知道，当父进程成功创建子进程后，可以通过调用</span>sys_wait4<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>来等待子进程执行完毕后再继续执行，那么这是如何实现的呢？当子进程被成功创建后，如果父进程调用了</span>sys_wait4<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，那么父进程将调用</span>add_wait_queue(&amp;current-&gt;wait_chldexit,&amp;wait);<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>把自己挂入到一个等待队列中，然后把自己状态设置成</span>TASK_INTERRUPTIBLE<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>状态，表示将要进入睡眠状态，但是可以被信号唤醒，随后调用</span>schedule<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>换入其他进程。当子进程退出时，其会执行</span>wake_up_parent(tsk-&gt;p_pptr);<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>唤醒在睡眠中的父进程，父进程立刻开始处理，如果发现唤醒自己正是自己等待结束的那个子进程，就释放掉该子进程，同时把自己状态调整成</span>TASK_RUNNING<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>并将自己从等待队列中移除。注意，本段的父进程主要指该子进程创建了子进程后自己成了父进程，而子进程指该子进程创建的子进程。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>这里就是重新初始化子进程的等待队列头部</span>wait_chldexit<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，因为该</span>wait_chldexit<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>是从父进程复制过来的，而此时该子进程正在创建过程，也根本不可能有自己的子进程，故一定要重新初始化自己的</span>wait_chldexit<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>为空，知道被创建完毕后，自己作为父进程创建子进程后调用</span>wait<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>时，把自己加入到一个等待队列中去。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>至于</span>612<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，</span>p-&gt;vfork_sem<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>前面信号量一节已经讲过。这里将子进程从父进程复制过来的</span>vfork_sem<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>置成</span>NULL<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，当子进程调用</span>vfork<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>时会设置该变量。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>当为进程设置</span>mm/files/fs/tty<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>资源或者修改进程的这些资源时（如增加文件的引用计数等）的时候，需要加锁，该锁就是进程的自旋锁</span>alloc_lock<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，这里</span>613<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>用于初始化该自旋锁。</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:60.2pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#E6E6E6;padding:0cm 5.4pt 0cm 5.4pt;
  height:60.2pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'>do</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Lucida Sans",sans-serif;color:red;
  mso-font-kerning:0pt'>_</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:9.0pt;font-family:"Courier New";color:red;mso-font-kerning:
  0pt'>fork :<o:p></o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
  normal'><span style='font-size:9.0pt;font-family:"Courier New";color:red;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></b></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>615<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>p</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;sigpending = 0;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>616<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>init</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>sigpending(&amp;</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:0pt'>p</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;pending);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>617<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent>task_struct-&gt;sigpending<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>如果等于</span>1<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>表示进程收到了信号但是未处理，如果等于</span>0<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>表示进程没有未处理的信号，而</span>task_struct-&gt;pending<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>链表中保存了所有未处理的信号，</span>init_sigpending(&amp;p-&gt;pending)
<span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>用于将保存为处理信号的链表初始化为空。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>现在来举例<span
style='background:yellow;mso-highlight:yellow'>设置</span></span><span
style='background:yellow;mso-highlight:yellow'>task_struct-&gt;sigpending=1</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的场景：当应用层调用</span>kill<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>命令向某个进程时发送指定信号时，最终调用</span>sys_kill<span style='font-family:
Wingdings;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-char-type:symbol;mso-symbol-font-family:Wingdings'><span style='mso-char-type:
symbol;mso-symbol-font-family:Wingdings'>à</span></span>kill_something_info<span
style='font-family:Wingdings;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Wingdings'><span style='mso-char-type:symbol;mso-symbol-font-family:Wingdings'>à</span></span>kill_proc_info<span
style='font-family:Wingdings;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Wingdings'><span style='mso-char-type:symbol;mso-symbol-font-family:Wingdings'>à</span></span><span
style='color:red'>send_sig_info</span><span style='font-family:Wingdings;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red;mso-char-type:symbol;mso-symbol-font-family:Wingdings'><span
style='mso-char-type:symbol;mso-symbol-font-family:Wingdings'>à</span></span><span
style='color:red'> deliver_signal</span><span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，在</span>deliver_signal<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中，会首先调用</span>send_signal<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>将该信号放入进程的</span>task_struct-&gt;pending<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>队列，然后调用</span>signal_wake_up<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>将</span>task_struct-&gt;sigpending<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>置</span>1<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，同时如果进程处于</span>TASK_INTERRUPTIBLE<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，则调用</span>wake_up_process<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>将该进程加入运行队列；又例如在用户空间访问内存</span><st1:chmetcnv
TCSC="0" NumberType="1" Negative="False" HasSpace="False" SourceValue="3"
UnitName="g" w:st="on">3G</st1:chmetcnv><span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>以上区域，将会导致页面访问异常，在异常处理中，会对该进程发送一个</span>SIGSEGV<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>信号；</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>下面是<span
style='background:aqua;mso-highlight:aqua'>清除</span></span><span
style='background:aqua;mso-highlight:aqua'>task_struct-&gt;sigpending=0</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的场景举例：如进程退出时</span>sys_exit<span
style='font-family:Wingdings;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Wingdings'><span style='mso-char-type:symbol;mso-symbol-font-family:Wingdings'>à</span></span>do_exit<span
style='font-family:Wingdings;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Wingdings'><span style='mso-char-type:symbol;mso-symbol-font-family:Wingdings'>à</span></span>exit_sighand<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中会设置</span>task_struct-&gt;sigpending=0<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，同时清除进程的</span>task_struct-&gt;pending<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>队列并释放其中元素的所占内存；</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>现在讲述利用</span><span
style='background:fuchsia;mso-highlight:fuchsia'>task_struct-&gt;sigpending</span><span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>来做判断的场景举例：例如当网络进程调用</span>sk-&gt;accept<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>等待连接接入时，最终会进入</span>tcp_accept<span
style='font-family:Wingdings;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Wingdings'><span style='mso-char-type:symbol;mso-symbol-font-family:Wingdings'>à</span></span>wait_for_connect<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>函数，我们来看看该函数的实现：</span></p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:267.4pt'>
  <td width=568 style='width:426.1pt;border:solid windowtext 1.0pt;mso-border-alt:
  solid windowtext .5pt;background:#CCFFCC;padding:0cm 5.4pt 0cm 5.4pt;
  height:267.4pt'>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>1996 </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>static</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:blue;mso-font-kerning:
  0pt'>int</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:#880000;mso-font-kerning:0pt'>wait</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:#880000;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>for</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:#880000;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#880000;mso-font-kerning:
  0pt'>connect</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>(</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>struct</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> sock * </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>sk</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>, </span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>long</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>timeo</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>1997 {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>1998<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;
  </span>DECLARE</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>WAITQUEUE(wait, </span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>current</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>1999<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>int</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>err</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2015<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>add</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>wait</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>queue</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>exclusive(</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>sk</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;sleep, &amp;wait);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2016<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>for</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> (;;) {<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2017<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>current</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>-&gt;</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>state</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'> = TASK</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>INTERRUPTIBLE;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2018<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>release</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>sock(</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>sk</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2019<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>if</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>sk</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>-&gt;tp</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>pinfo.af</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>tcp.accept</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>queue == </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#A000A0;mso-font-kerning:0pt'>NULL</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2020<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>timeo</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> = schedule</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>timeout(</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>timeo</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2021<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>lock</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>sock(</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>sk</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2022<span style='mso-spacerun:yes'>&nbsp; </span><span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>err</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> = 0;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2023<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>if</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>sk</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>-&gt;tp</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>pinfo.af</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>tcp.accept</span><span style='font-size:
  9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>queue)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2024<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>break</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2025<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>err</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> = -</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>EINVAL</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2026<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>if</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>sk</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>-&gt;</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>state</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> != TCP</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>LISTEN)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2027<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>break</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2028<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>err</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> = sock</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>intr</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;
  color:black;mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>errno(</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>timeo</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2029<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>if</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (signal</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>pending(</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>current</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>))<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2030<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>break</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2031<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>err</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> = -</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:#A000A0;mso-font-kerning:
  0pt'>EAGAIN</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2032<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:#880000;mso-font-kerning:0pt'>if</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> (!</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:gray;mso-font-kerning:
  0pt'>timeo</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:black;mso-font-kerning:0pt'>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2033<span
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:blue;mso-font-kerning:0pt'>break</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2034<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2035<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>current</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>state</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'> = TASK</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>RUNNING;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2036<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;
  </span>remove</span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Lucida Sans",sans-serif;color:black;mso-font-kerning:0pt'>_</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>wait</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Lucida Sans",sans-serif;color:black;
  mso-font-kerning:0pt'>_</span><span style='font-size:9.0pt;mso-bidi-font-size:
  12.0pt;font-family:"Courier New";color:black;mso-font-kerning:0pt'>queue(</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:gray;mso-font-kerning:0pt'>sk</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>-&gt;sleep, &amp;wait);<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2037<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:blue;mso-font-kerning:0pt'>return</span><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'> </span><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Courier New";color:gray;mso-font-kerning:0pt'>err</span><span
  style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:black;mso-font-kerning:0pt'>;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:9.0pt;mso-line-height-rule:exactly;
  mso-layout-grid-align:none;text-autospace:none'><span style='font-size:9.0pt;
  mso-bidi-font-size:12.0pt;font-family:"Courier New";color:black;mso-font-kerning:
  0pt'>2038 }<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>首先将自己加入到</span>sk-&gt;sleep<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>队列中，同时将当前进程设置成</span>TASK_INTERRUPTIBLE<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>状态，然后调用</span>schedule<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>让自己进入睡眠状态，同时切入其他程序运行，当网卡收到接入数据包时，最终进入</span>tcp_v4_do_rcv<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，该函数除了为接入数据包建立起新的</span>socket<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>之外，还唤醒正在</span>listen_sock-&gt;sleep<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>睡眠队列中的当前进程，当前进程随即进入</span>CPU<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>恢复运行，由于此时</span>accept_queue<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>必然不为零，故从</span>for(;;)<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>循环中跳出，随后进入运行状态并从</span>wait_for_connect<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中返回继续运行；但是如果网卡一直没有数据到来，而且上层是按照堵塞方式调用</span>accept<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的，那么如果没有其他情况，进程必然一直处于睡眠状态也就是停止于</span>schedule_timeout<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中，但是如果现在该进程受到了</span>kill<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>信号，如签名所说，最终</span>deliver_signal<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>会首先调用</span>send_signal<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>将该信号放入进程的</span>task_struct-&gt;pending<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>队列，然后调用</span>signal_wake_up<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>将</span>task_struct-&gt;sigpending<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>置</span>1<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，同时如果进程处于</span>TASK_INTERRUPTIBLE<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，则调用</span>wake_up_process<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>将该进程加入运行队列，故回到</span>2021<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>行往下运行，很明显此时</span>accept_queue<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>为</span>NULL<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，如果没有</span>2029<span lang=ZH-CN style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>行的判断，很显然循环将继续，这样在阻塞模式下该进程连</span>kill<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>都无法</span>kill<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>掉了，而正因为有了</span>2029<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>行的判断，由于此时</span>task_struct-&gt;sigpending<span
lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>为</span>1<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，故跳出循环从</span>wait_for_connect<span lang=ZH-CN
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中返回继续运行知道处理</span>kill<span lang=ZH-CN style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>信号对于的处理程序。</span></p>

<p class=MsoNormalIndent><span lang=ZH-CN style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>关于信号的详细处理将会在进程间通信一节中详细讲到。</span></p>

</div>

</body>

</html>
